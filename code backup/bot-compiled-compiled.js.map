{"version":3,"sources":["bot-compiled.js"],"names":[],"mappings":"AAAA;;;;;;AAMA,MAAM,KAAK,QAAQ,eAAR,CAAX;AACA,MAAM,SAAS,QAAQ,sBAAR,CAAf;AACA,MAAM,SAAS,QAAQ,aAAR,CAAf;AACA,MAAM,WAAW,QAAQ,oBAAR,CAAjB;AACA,MAAM,WAAW,QAAQ,eAAR,CAAjB;AACA,IAAI,OAAO,QAAQ,MAAR,CAAX;AACA,IAAI,YAAY,QAAQ,uBAAR,CAAhB;AACA,MAAM,WAAW,QAAQ,eAAR,CAAjB;AACA,MAAM,aAAa,QAAQ,cAAR,CAAnB;;AAEA,IAAI,SAAS,QAAQ,wBAAR,CAAb;AACA,MAAM,SAAS,QAAQ,aAAR,CAAf;AACA,MAAM,WAAW,QAAQ,cAAR,CAAjB;AACA,MAAM,YAAY,QAAQ,gBAAR,CAAlB;AACA,IAAI,QAAQ,QAAQ,OAAR,CAAZ;AACA,IAAI,UAAU,QAAQ,SAAR,CAAd;AACA,MAAM,UAAU,QAAQ,cAAR,CAAhB;AACA,MAAM,SAAS,QAAQ,aAAR,CAAf;AACA,MAAM,KAAK,QAAQ,iBAAR,CAAX;AACA,IAAI,SAAS,QAAQ,QAAR,CAAb;;AAEA,SAAS,cAAT,CAAwB,SAAxB,EAAmC,OAAnC,EAA4C,QAA5C,EAAsD,OAAtD,EAA+D,QAA/D,EAAyE;;;;AAIrE,QAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;;AAEA,WAAO,sBAAP,CAA8B,QAA9B;AACA,cAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,aAAlC,EAAiD,QAAjD,EAA2D,SAA3D,CAAV;AACA,cAAU,OAAO,0BAAP,CAAkC,OAAlC,EAA2C,QAA3C,EAAqD,SAArD,CAAV;;AAEA,QAAI,WAAW,OAAO,gBAAP,CAAwB,QAAxB,EAAkC,UAAlC,CAAf;AACA,QAAI,YAAY,QAAQ,MAAxB,EAAgC,SAAS,kBAAT,CAA4B,SAA5B,EAAuC,cAAvC,EAAuD,CAAC,QAAD,CAAvD;AAChC,QAAI,QAAJ,EAAc,UAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,UAAlC,EAA8C,QAA9C,EAAwD,SAAxD,CAAV;;AAEd,QAAI,SAAS,OAAO,gBAAP,CAAwB,QAAxB,EAAkC,QAAlC,CAAb;;;;AAIA,QAAI,MAAJ,EAAY,UAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,QAAlC,EAA4C,MAA5C,EAAoD,SAApD,CAAV;;AAEZ,QAAI,QAAQ,SAAZ,EAAuB;AACnB,YAAI,iBAAiB,OAAO,cAAP,CAAsB,QAAtB,EAAgC,WAAhC,CAArB;AACA,kBAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,gBAAlC,EAAoD,cAApD,EAAoE,SAApE,CAAV;AACH;;AAED,QAAI,QAAQ,OAAO,gBAAP,CAAwB,QAAxB,EAAkC,OAAlC,CAAZ;AACA,QAAI,KAAJ,EAAW;AACP,YAAI,SAAS,MAAb,EAAqB,UAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,MAAlC,EAA0C,MAA1C,EAAkD,SAAlD,CAAV;AACrB,YAAI,SAAS,KAAb,EAAoB,UAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,KAAlC,EAAyC,KAAzC,EAAgD,SAAhD,CAAV;AACpB,YAAI,SAAS,KAAb,EAAoB,UAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,KAAlC,EAAyC,KAAzC,EAAgD,SAAhD,CAAV;AACpB,YAAI,SAAS,MAAb,EAAqB,UAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,MAAlC,EAA0C,MAA1C,EAAkD,SAAlD,CAAV;AACxB;;AAED,QAAI,QAAQ,KAAZ,EAAmB;AACf,YAAI,QAAQ,SAAZ,EAAuB,UAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,WAAlC,EAA+C,QAAQ,SAAvD,EAAkE,SAAlE,CAAV;AACvB,YAAI,QAAQ,WAAZ,EAAyB,UAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,kBAAlC,EAAsD,QAAQ,WAA9D,EAA2E,SAA3E,CAAV,CAAzB,KAA8H,UAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,kBAAlC,EAAsD,OAAtD,EAA+D,SAA/D,CAAV;AACjI;;AAED,cAAU,OAAO,gBAAP,CAAwB,OAAxB,EAAiC,OAAjC,EAA0C,SAA1C,CAAV;;AAEA,QAAI,UAAU,OAAO,gBAAP,CAAwB,QAAxB,EAAkC,aAAlC,CAAd;AACA,QAAI,SAAS,OAAO,gBAAP,CAAwB,QAAxB,EAAkC,QAAlC,CAAb;AACA,QAAI,MAAJ,EAAY,UAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,QAAlC,EAA4C,MAA5C,EAAoD,SAApD,CAAV;;AAEZ,QAAI,QAAQ,OAAO,gBAAP,CAAwB,QAAxB,EAAkC,OAAlC,CAAZ;AACA,QAAI,KAAJ,EAAW;AACP,kBAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,OAAlC,EAA2C,KAA3C,EAAkD,SAAlD,CAAV;AACA,YAAI,CAAC,OAAO,WAAP,CAAmB,YAAnB,EAAiC,aAAa,WAA9C,CAAL,EAAiE,SAAS,kBAAT,CAA4B,SAA5B,EAAuC,YAAvC,EAAqD,EAArD;AACpE;;AAED,QAAI,QAAQ,KAAZ,EAAmB;AACf,kBAAU,EAAV;AACA,kBAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,OAAlC,EAA2C,QAAQ,KAAnD,EAA0D,SAA1D,CAAV;AACH;AACD,QAAI,QAAQ,MAAR,IAAkB,QAAtB,EAAgC;AAC5B,kBAAU,EAAV;AACA,kBAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,QAAlC,EAA4C,OAA5C,EAAqD,SAArD,CAAV;AACH;;AAED,YAAQ,GAAR,CAAY,qDAAZ;AACA,YAAQ,GAAR,CAAY,OAAZ;AACA,YAAQ,GAAR,CAAY,qDAAZ;;AAEA,cAAU,QAAQ,WAAR,EAAV;AACA,WAAO,WAAP,CAAmB,OAAnB,EAA4B,UAAU,IAAV,EAAgB;AACxC,YAAI,UAAU,KAAK,MAAL,CAAd;AACA,YAAI,YAAY,KAAK,SAAL,CAAhB;AACA,YAAI,CAAC,OAAO,WAAP,CAAmB,SAAnB,EAA8B,OAA9B,KAA0C,OAAO,WAAP,CAAmB,QAAnB,EAA6B,OAA7B,CAA3C,KAAqF,QAAQ,MAAR,IAAkB,CAA3G,EAA8G;AAC1G,sBAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,MAAlC,EAA0C,QAAQ,CAAR,CAA1C,EAAsD,SAAtD,CAAV;AACA,sBAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,MAAlC,EAA0C,QAAQ,CAAR,CAA1C,EAAsD,SAAtD,CAAV;AACA,mBAAO,QAAQ,GAAf;AACA,iBAAK,IAAI,CAAT,IAAc,SAAd,EAAyB,UAAU,QAAQ,OAAR,CAAgB,UAAU,CAAV,CAAhB,EAA8B,EAA9B,CAAV;AAC5B,SALD,MAKO,IAAI,QAAQ,MAAR,IAAkB,CAAtB,EAAyB;AAC5B,sBAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,KAAlC,EAAyC,QAAQ,CAAR,CAAzC,EAAqD,SAArD,CAAV;AACH;;AAED,aAAK,IAAI,CAAT,IAAc,SAAS,SAAvB,EAAkC;AAC9B,gBAAI,WAAW,SAAS,SAAT,CAAmB,CAAnB,CAAf;AACA,gBAAI,aAAa,OAAb,EAAsB,QAAtB,CAAJ,EAAqC;AACjC,0BAAU,EAAV;AACA,0BAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,kBAAlC,EAAsD,QAAtD,EAAgE,SAAhE,CAAV;AACA;AACH;AACJ;;AAED,aAAK,IAAI,CAAT,IAAc,SAAS,UAAvB,EAAmC;AAC/B,gBAAI,WAAW,SAAS,UAAT,CAAoB,CAApB,CAAf;AACA,gBAAI,aAAa,OAAb,EAAsB,QAAtB,CAAJ,EAAqC;AACjC,oBAAI,EAAE,OAAO,WAAP,CAAmB,MAAnB,EAA2B,OAA3B,KAAuC,OAAO,WAAP,CAAmB,MAAnB,EAA2B,OAA3B,CAAzC,CAAJ,EAAmF;AAC/E,8BAAU,EAAV;AACA,8BAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,kBAAlC,EAAsD,QAAtD,EAAgE,SAAhE,CAAV;AACA;AACH;AACJ;AACJ;;AAED,aAAK,IAAI,CAAT,IAAc,SAAS,UAAvB,EAAmC;AAC/B,gBAAI,WAAW,SAAS,UAAT,CAAoB,CAApB,CAAf;AACA,gBAAI,aAAa,OAAb,EAAsB,QAAtB,CAAJ,EAAqC;AACjC,oBAAI,QAAQ,WAAR,MAAyB,IAAzB,IAAiC,QAAQ,WAAR,MAAyB,GAA9D,EAAmE;AAC/D,8BAAU,EAAV;AACA,8BAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,kBAAlC,EAAsD,QAAtD,EAAgE,SAAhE,CAAV;AACA;AACH;AACJ;AACJ;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4BD,YAAI,CAAC,OAAO,WAAP,CAAmB,OAAnB,EAA4B,OAA5B,CAAD,IAAyC,CAAC,OAAO,WAAP,CAAmB,WAAnB,EAAgC,OAAhC,CAA9C,EAAwF;AACpF,mBAAO,aAAP,CAAqB,OAArB,EAA8B,OAA9B,EAAuC,SAAvC,EAAkD,QAAlD,EAA4D,UAAU,IAAV,EAAgB;AACxE,4BAAY,SAAS,IAAT,CAAZ;AACH,aAFD;AAGH,SAJD,MAIO;AACH,wBAAY,SAAS,OAAT,CAAZ;AACH;AACJ,KA5ED;AA6EH;;;AAGD,MAAM,UAAU;;AAEZ,QAAI,SAAJ,EAAe,OAAf,EAAwB,QAAxB,EAAkC;;;AAG9B,YAAI,QAAQ,IAAR,KAAiB,MAArB,EAA6B;;AAEzB;AACH;AACD,cAAM,cAAc,SAAS,QAAT,CAAkB,SAAlB,CAApB;AACA,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;;AAEA,YAAI,eAAe,iBAAiB,SAApC,EAA+C;;AAE3C,uBAAW,OAAO,wBAAP,CAAgC,QAAhC,EAA0C,IAA1C,CAAX;AACA,uBAAW,OAAO,wBAAP,CAAgC,QAAhC,EAA0C,GAA1C,CAAX;;AAEA,kBAAM,UAAN,CAAiB,QAAjB,EAA2B,UAAU,QAAV,EAAoB,MAApB,EAA4B;AACnD,oBAAI,SAAS,MAAT,MAAqB,MAAzB,EAAiC;AAC7B,uBAAG,SAAH,CAAa,WAAb,EAA0B,SAAS,SAAT,CAA1B,EAA+C,UAAU,IAAV,EAAgB;AAC3D;AACH,qBAFD;AAGH,iBAJD,MAIO,IAAI,SAAS,MAAT,MAAqB,MAAzB,EAAiC;AACpC,uBAAG,gBAAH,CAAoB,WAApB,EAAiC,SAAS,SAAT,CAAjC,EAAsD,UAAU,IAAV,EAAgB;AAClE;AACH,qBAFD;AAGH;AACJ,aAVD;AAWH;AACJ,KA7BW;AA8BZ,UAAM,SAAN,EAAiB,OAAjB,EAA0B,QAA1B,EAAoC,OAApC,EAA6C,EAA7C,EAAiD;;;AAG7C,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,YAAI,OAAO,SAAS,QAAT,CAAkB,SAAlB,CAAX;AACA,iBAAS,WAAT,CAAqB,SAArB,EAAgC,cAAhC,EAAgD,OAAhD;;AAEA,uBAAe,SAAf,EAA0B,OAA1B,EAAmC,QAAnC,EAA6C,OAA7C,EAAsD,UAAU,OAAV,EAAmB;;AAErE,oBAAQ,GAAR,CAAY,oDAAZ;AACA,oBAAQ,GAAR,CAAY,OAAZ;AACA,oBAAQ,GAAR,CAAY,oDAAZ;;AAEA,gBAAI,eAAe,UAAU,eAAV,CAA0B,OAA1B,CAAnB;AACA,oBAAQ,GAAR,CAAY,wBAAwB,YAApC;AACA,gBAAI,gBAAgB,IAApB,EAA0B;AACtB,yBAAS,WAAT,CAAqB,SAArB,EAAgC,aAAhC,EAA+C,YAA/C;AACA,yBAAS,WAAT,CAAqB,SAArB,EAAgC,oBAAhC,EAAsD,OAAtD;AACH;;AAED,gBAAI,yBAAyB,EAA7B;AACA,mCAAuB,eAAvB,IAA0C,OAA1C;AACA,mCAAuB,cAAvB,IAAyC,YAAzC;AACA,eAAG,sBAAH;AACH,SAjBD;AAkBH,KAvDW;AAwDZ,UAAM,SAAN,EAAiB,OAAjB,EAA0B,KAA1B,EAAiC;AAC7B,gBAAQ,GAAR,CAAY,MAAM,OAAlB;AACA,gBAAQ,KAAR,GAAgB,OAAhB;AACH,KA3DW;;;;;AAgEZ,KAAC,eAAD,EAAkB,SAAlB,EAA6B,OAA7B,EAAsC,MAAtC,EAA8C,EAA9C,EAAkD;;AAE9C,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,YAAI,YAAY,EAAhB;AACA,YAAI,aAAa,EAAjB;AACA,YAAI,SAAS,EAAb;AACA,YAAI,KAAJ;AACA,YAAI,mBAAJ;AACA,YAAI,gBAAJ;AACA,YAAI,cAAc,EAAlB;AACA,iBAAS,WAAT,CAAqB,SAArB,EAAgC,oBAAhC,EAAsD,EAAtD;AACA,YAAI,cAAc,EAAlB;AACA,YAAI,OAAO,WAAP,CAAmB,cAAnB,EAAmC,aAAa,WAAhD,CAAJ,EAAkE,cAAc,aAAa,WAAb,CAAyB,YAAvC;;AAElE,YAAI,OAAO,WAAP,CAAmB,QAAnB,EAA6B,OAA7B,CAAJ,EAA2C;AACvC,gBAAI,MAAM,QAAQ,MAAR,CAAe,WAAf,EAAV;AACA,oBAAQ,GAAR,CAAY,mBAAZ,EAAiC,GAAjC;AACA,gBAAI,sBAAsB,EAA1B;AACA,gBAAI,OAAO,kBAAX,EAA+B,oBAAoB,IAApB,CAAyB,QAAzB,EAA/B,KAAuE,IAAI,OAAO,mBAAX,EAAgC,oBAAoB,IAApB,CAAyB,SAAzB,EAAhC,KAAyE,IAAI,OAAO,kBAAX,EAA+B,oBAAoB,IAApB,CAAyB,QAAzB,EAA/B,KAAuE,IAAI,OAAO,mBAAX,EAAgC,oBAAoB,IAApB,CAAyB,aAAzB,EAAhC,KAA6E,IAAI,OAAO,wBAAX,EAAqC,oBAAoB,IAApB,CAAyB,yBAAzB;AACzU,oBAAQ,GAAR,CAAY,mBAAZ;AACA,gBAAI,oBAAoB,MAApB,GAA6B,CAAjC,EAAoC;AAChC,uBAAO,QAAQ,MAAf;AACA,yBAAS,kBAAT,CAA4B,SAA5B,EAAuC,cAAvC,EAAuD,mBAAvD;AACH;AACD,gBAAI,YAAY,MAAZ,IAAsB,CAA1B,EAA6B;AACzB,4BAAY,SAAS,mBAAT,CAA6B,GAA7B,IAAoC,SAAS,aAAT,CAAuB,GAAvB,CAApC,GAAkE,SAA9E;AACA,sCAAsB,SAAS,cAAT,CAAwB,GAAxB,IAA+B,SAAS,gBAAT,CAA0B,GAA1B,CAA/B,GAAgE,SAAtF;AACH;AACJ;;AAED,YAAI,OAAO,WAAP,CAAmB,aAAnB,EAAkC,aAAa,WAA/C,KAA+D,OAAO,WAAP,CAAmB,WAAnB,EAAgC,aAAa,WAA7C,CAAnE,EAA8H;AAC1H,qBAAS;AACL,yBAAS;AACL,6BAAS;AACL,+BAAO,aAAa,WAAb,CAAyB,WAD3B;AAEL,+BAAO,aAAa,WAAb,CAAyB;AAF3B;AADJ;AADJ,aAAT;AAQH;;AAED,YAAI,OAAO,WAAP,CAAmB,SAAnB,EAA8B,OAA9B,CAAJ,EAA4C;AACxC,oBAAQ,GAAR,CAAY,eAAZ;AACA,wBAAY,SAAS,aAAT,CAAuB,SAAvB,CAAZ;AACA,oBAAQ,EAAE,MAAM,EAAE,YAAY,CAAC,EAAE,SAAS,EAAE,WAAW,CAAb,EAAX,EAAD,CAAd,EAAR,EAAR;AACA,qBAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,KAA/B,EAAsC,EAAtC,EAA0C,UAA1C,EAAsD,MAAtD,CAAT;AACA,yBAAa,OAAO,OAAP,CAAb;AACA,qBAAS,OAAO,QAAP,CAAT;AACH;;AAED,YAAI,OAAO,WAAP,CAAmB,OAAnB,EAA4B,OAA5B,CAAJ,EAA0C;AACtC,oBAAQ,GAAR,CAAY,cAAZ;AACA,oBAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,EAAE,SAAS,EAAE,SAAS,QAAQ,KAAnB,EAAX,EAAD,CAAV,EAAR,EAAR;AACA,qBAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,KAA/B,EAAsC,EAAtC,EAA0C,UAA1C,EAAsD,MAAtD,CAAT;AACA,yBAAa,OAAO,OAAP,CAAb;AACA,qBAAS,OAAO,QAAP,CAAT;AACH;;AAED,YAAI,OAAO,WAAP,CAAmB,IAAnB,EAAyB,OAAzB,CAAJ,EAAuC;AACnC,oBAAQ,GAAR,CAAY,eAAZ;AACA,wBAAY,SAAS,aAAT,CAAuB,IAAvB,CAAZ;AACA,oBAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,EAAE,SAAS,EAAE,MAAM,QAAQ,EAAhB,EAAX,EAAD,CAAV,EAAR,EAAR;AACA,qBAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,KAA/B,EAAsC,EAAtC,EAA0C,UAA1C,EAAsD,MAAtD,CAAT;AACA,yBAAa,OAAO,OAAP,CAAb;AACA,qBAAS,OAAO,QAAP,CAAT;AACH;;AAED,YAAI,OAAO,WAAP,CAAmB,UAAnB,EAA+B,OAA/B,CAAJ,EAA6C;AACzC,oBAAQ,GAAR,CAAY,gBAAZ;AACA,oBAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,EAAE,SAAS,EAAE,YAAY,QAAQ,QAAtB,EAAX,EAAD,CAAV,EAAR,EAAR;AACA,qBAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,KAA/B,EAAsC,EAAtC,EAA0C,UAA1C,EAAsD,MAAtD,CAAT;AACA,yBAAa,OAAO,OAAP,CAAb;AACA,qBAAS,OAAO,QAAP,CAAT;AACH;;AAED,YAAI,OAAO,WAAP,CAAmB,iBAAnB,EAAsC,OAAtC,CAAJ,EAAoD;AAChD,oBAAQ,GAAR,CAAY,uBAAZ;AACA,oBAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,EAAE,SAAS,EAAE,mBAAmB,QAAQ,eAA7B,EAAX,EAAD,CAAV,EAAR,EAAR;AACA,qBAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,KAA/B,EAAsC,EAAtC,EAA0C,UAA1C,EAAsD,MAAtD,CAAT;AACA,yBAAa,OAAO,OAAP,CAAb;AACA,qBAAS,OAAO,QAAP,CAAT;AACH;;AAED,YAAI,OAAO,WAAP,CAAmB,gBAAnB,EAAqC,OAArC,CAAJ,EAAmD;AAC/C,oBAAQ,GAAR,CAAY,wBAAZ;AACA,oBAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,EAAE,gBAAgB,EAAE,kBAAkB,QAAQ,cAA5B,EAAlB,EAAD,CAAV,EAAR,EAAR;AACA,qBAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,KAA/B,EAAsC,EAAtC,EAA0C,UAA1C,EAAsD,MAAtD,CAAT;AACA,yBAAa,OAAO,OAAP,CAAb;AACA,qBAAS,OAAO,QAAP,CAAT;AACH;;AAED,YAAI,OAAO,WAAP,CAAmB,cAAnB,EAAmC,OAAnC,CAAJ,EAAiD;AAC7C,oBAAQ,GAAR,CAAY,qBAAZ;AACA,oBAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,EAAE,gBAAgB,EAAE,gBAAgB,QAAQ,YAA1B,EAAlB,EAAD,CAAV,EAAR,EAAR;AACA,qBAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,KAA/B,EAAsC,EAAtC,EAA0C,UAA1C,EAAsD,MAAtD,CAAT;AACA,yBAAa,OAAO,OAAP,CAAb;AACA,qBAAS,OAAO,QAAP,CAAT;AACH;;AAED,YAAI,OAAO,WAAP,CAAmB,aAAnB,EAAkC,OAAlC,CAAJ,EAAgD;AAC5C,oBAAQ,GAAR,CAAY,qBAAZ;AACA,oBAAQ,EAAE,MAAM,EAAE,QAAQ,CAAC,EAAE,gBAAgB,EAAE,WAAW,QAAQ,WAArB,EAAlB,EAAD,CAAV,EAAR,EAAR;AACA,qBAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,KAA/B,EAAsC,EAAtC,EAA0C,UAA1C,EAAsD,MAAtD,CAAT;AACA,yBAAa,OAAO,OAAP,CAAb;AACA,qBAAS,OAAO,QAAP,CAAT;AACH;;AAED,YAAI,OAAO,WAAP,CAAmB,kBAAnB,EAAuC,OAAvC,CAAJ,EAAqD;AACjD,oBAAQ,GAAR,CAAY,wBAAZ;AACA,gBAAI,MAAM,QAAQ,gBAAR,CAAyB,WAAzB,EAAV;AACA,wBAAY,SAAS,mBAAT,CAA6B,GAA7B,IAAoC,SAAS,aAAT,CAAuB,GAAvB,CAApC,GAAkE,SAA9E;AACA,kCAAsB,SAAS,cAAT,CAAwB,GAAxB,IAA+B,SAAS,gBAAT,CAA0B,GAA1B,CAA/B,GAAgE,SAAtF;AACH;;AAED,YAAI,OAAO,WAAP,CAAmB,cAAnB,EAAmC,OAAnC,CAAJ,EAAiD;AAC7C,gBAAI,QAAQ,SAAS,WAAT,CAAqB,QAAQ,YAA7B,CAAZ;AACA,qBAAS,EAAE,OAAO,CAAC;AACX,6BAAS;AACL,0CAAkB,EAAE,OAAO,MAAM,UAAf;AACd,mCAAO,MAAM,QADC;AADb;AADE,iBAAD,EAKX;AACC,6BAAS;AACL,iCAAS,EAAE,OAAO,aAAa,WAAb,CAAyB,WAAlC;AACL,mCAAO,aAAa,WAAb,CAAyB,SAD3B;AADJ;AADV,iBALW;AAAT,aAAT;AAYA,qBAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,EAA/B,EAAmC,MAAnC,EAA2C,UAA3C,EAAuD,MAAvD,CAAT;;AAEA,yBAAa,OAAO,OAAP,CAAb;AACA,qBAAS,OAAO,QAAP,CAAT;AACH;;AAED,YAAI,OAAO,WAAP,CAAmB,WAAnB,EAAgC,OAAhC,CAAJ,EAA8C;AAC1C,gBAAI,iBAAiB,QAAQ,cAA7B;AACA,iBAAK,IAAI,CAAT,IAAc,cAAd,EAA8B;AAC1B,oBAAI,YAAY,eAAe,CAAf,CAAhB;AACA,oBAAI,aAAa,EAAjB;AACA,oBAAI,wBAAwB,IAA5B;AACA,oBAAI,qBAAqB,IAAzB;AACA,oBAAI,mBAAmB,OAAO,cAAP,CAAsB,QAAQ,WAA9B,EAA2C,SAA3C,CAAvB;AACA,wBAAQ,GAAR,CAAY,SAAZ;AACA,wBAAQ,GAAR,CAAY,QAAQ,WAApB;AACA,wBAAQ,GAAR,CAAY,kBAAZ;AACA,wBAAQ,GAAR,CAAY,gBAAZ;;AAEA,mCAAmB,SAAS,aAAT,CAAuB,UAAU,WAAV,EAAvB,IAAkD,SAAS,QAAT,CAAkB,UAAU,WAAV,EAAlB,CAAlD,GAA+F,SAAlH;;;AAGA,qBAAK,IAAI,CAAT,IAAc,gBAAd,EAAgC;AAC5B,wBAAI,QAAQ,iBAAiB,CAAjB,CAAZ;AACA,wBAAI,CAAC,OAAD,EAAU,OAAV,EAAmB,OAAnB,EAA4B,OAA5B,EAAqC,SAArC,EAAgD,KAAhD,EAAuD,OAAvD,CAA+D,KAA/D,IAAwE,CAAC,CAA7E,EAAgF;AAC5E,gDAAwB,KAAxB;AACH,qBAFD,MAEO,IAAI,CAAC,MAAM,KAAN,CAAL,EAAmB;AACtB,6CAAqB,SAAS,KAAT,EAAgB,EAAhB,CAArB;AACH;AACJ;;;AAGD,oBAAI,sBAAsB,IAA1B,EAAgC;AAC5B,wBAAI,yBAAyB,OAAzB,IAAoC,yBAAyB,OAA7D,IAAwE,yBAAyB,IAArG,EAA2G,WAAW,gBAAX,IAA+B,EAAE,KAAK,kBAAP,EAA/B,CAA3G,KAA2K,IAAI,yBAAyB,OAA7B,EAAsC,WAAW,gBAAX,IAA+B,EAAE,KAAK,CAAP,EAAU,KAAK,kBAAf,EAA/B;AACjN,4BAAQ,GAAR,CAAY,qBAAqB,KAAK,SAAL,CAAe,UAAf,EAA2B,IAA3B,EAAiC,CAAjC,CAAjC;AACA,gCAAY,IAAZ,CAAiB,EAAE,SAAS,UAAX,EAAjB;;AAEA,wBAAI,mBAAmB,EAAvB;AACA,qCAAiB,KAAjB,IAA0B,WAA1B;;AAEA,6BAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,EAA/B,EAAmC,gBAAnC,EAAqD,UAArD,EAAiE,MAAjE,CAAT;;AAEA,iCAAa,OAAO,OAAP,CAAb;AACA,6BAAS,OAAO,QAAP,CAAT;AACA,4BAAQ,GAAR,CAAY,6BAAZ;AACH,iBAbD,MAaO;AACH,4BAAQ,GAAR,CAAY,sBAAZ,EAAoC,QAAQ,SAA5C;AACA,gCAAY,SAAS,mBAAT,CAA6B,SAA7B,IAA0C,SAAS,aAAT,CAAuB,SAAvB,CAA1C,GAA8E,EAA1F;AACA,4BAAQ,SAAS,aAAT,CAAuB,SAAvB,IAAoC,SAAS,UAAT,CAAoB,SAApB,CAApC,GAAqE,EAA7E;AACA,6BAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,KAA/B,EAAsC,EAAtC,EAA0C,UAA1C,EAAsD,MAAtD,CAAT;AACA,iCAAa,OAAO,OAAP,CAAb;AACA,4BAAQ,GAAR,CAAY,SAAZ,EAAuB,UAAvB;AACA,6BAAS,OAAO,QAAP,CAAT;AACA,6BAAS,kBAAT,CAA4B,SAA5B,EAAuC,cAAvC,EAAuD,CAAC,SAAD,CAAvD;;AAEA,wBAAI,SAAS,cAAT,CAAwB,SAAxB,CAAJ,EAAwC,sBAAsB,SAAS,eAAT,CAAyB,YAAzB,EAAuC,SAAS,gBAAT,CAA0B,SAA1B,CAAvC,CAAtB;AAC3C;AACJ;AACD,gBAAI,qBAAqB,EAAE,SAAS,EAAE,OAAO,aAAa,WAAb,CAAyB,WAAlC;AAC5B,2BAAO,aAAa,WAAb,CAAyB,SADJ,EAAX,EAAzB;AAEA,wBAAY,IAAZ,CAAiB,EAAE,SAAS,kBAAX,EAAjB;AACH;;;;;AAKD,YAAI,mBAAJ,EAAyB,SAAS,WAAT,CAAqB,SAArB,EAAgC,qBAAhC,EAAuD,mBAAvD;;AAEzB,YAAI,WAAW,EAAf;AACA,YAAI,MAAJ;;;AAGA,YAAI,OAAO,WAAP,CAAmB,WAAnB,EAAgC,YAAhC,KAAiD,CAAC,OAAO,WAAP,CAAmB,kBAAnB,EAAuC,OAAvC,CAAlD,IAAqG,CAAC,OAAO,WAAP,CAAmB,eAAnB,EAAoC,OAApC,CAAtG,IAAsJ,CAAC,OAAO,WAAP,CAAmB,YAAnB,EAAiC,OAAjC,CAA3J,EAAsM;AAClM,gBAAI,iBAAiB,EAArB;AACA,2BAAe,QAAf,IAA2B,SAAS,WAAT,CAAqB,kBAArB,CAA3B;AACA,2BAAe,SAAf,IAA4B,CAAC,KAAD,EAAQ,IAAR,CAA5B;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,SAAR,EAAmB,SAAS,cAA5B,EAAd;AACA,qBAAS,WAAT,CAAqB,SAArB,EAAgC,cAAhC,EAAgD,kBAAhD;AACA,eAAG,OAAH,EAAY,QAAZ;AACA;AACH;;AAED,YAAI,4BAA4B,OAAO,WAAP,CAAmB,kBAAnB,EAAuC,OAAvC,KAAmD,OAAO,WAAP,CAAmB,eAAnB,EAAoC,OAApC,CAAnF;;AAEA,YAAI,OAAO,WAAP,CAAmB,WAAnB,EAAgC,YAAhC,KAAiD,yBAArD,EAAgF;AAC5E,gBAAI,SAAS,QAAQ,gBAArB;;AAEA,gBAAI,UAAU,KAAV,IAAmB,OAAO,WAAP,CAAmB,eAAnB,EAAoC,OAApC,CAAvB,EAAqE;AACjE,wBAAQ,GAAR,CAAY,eAAZ;AACA,oBAAI,kBAAkB,aAAa,eAAb,CAA6B,UAAnD;AACA,oBAAI,cAAc,aAAa,eAAb,CAA6B,MAA/C;AACA,oBAAI,SAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,UAA/B,EAA2C,MAA3C,EAAmD,eAAnD,EAAoE,WAApE,CAAb;AACA,6BAAa,OAAO,OAAP,CAAb;AACA,yBAAS,OAAO,QAAP,CAAT;;AAEA,oBAAI,YAAY,MAAZ,GAAqB,CAAzB,EAA4B,UAAU,YAAY,CAAZ,CAAV,CAA5B,KAA0D,IAAI,OAAO,WAAP,CAAmB,QAAnB,EAA6B,OAA7B,CAAJ,EAA2C,UAAU,QAAQ,MAAR,CAAe,WAAf,GAA6B,IAA7B,EAAV;;AAErG,oBAAI,cAAc,OAAO,IAAP,CAAY,UAAZ,EAAwB,MAAxB,IAAkC,CAApD,EAAuD,aAAa,SAAb;AACvD,oBAAI,aAAa,OAAO,IAAP,CAAY,SAAZ,EAAuB,MAAvB,IAAiC,CAAlD,EAAqD,YAAY,SAAZ;;AAErD,oBAAI,YAAY,aAAa,iBAAb,CAAhB;AACA,oBAAI,SAAS,aAAa,qBAAb,CAAb;AACA,oBAAI,YAAY,EAAhB;AACA,qBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,OAAO,MAA3B,EAAmC,GAAnC,EAAwC;AACpC,8BAAU,IAAV,CAAe,SAAS,OAAO,CAAP,CAAT,CAAf;AACH;;AAED,yBAAS,SAAS,kBAAT,CAA4B,YAA5B,CAAT;;;AAGA,oBAAI,MAAM,MAAN,KAAiB,IAArB,EAA2B,QAAQ,EAAE,QAAQ,EAAE,QAAQ,CAAC,EAAE,OAAO,EAAE,UAAU,MAAZ,EAAT,EAAD,CAAV,EAAV,EAAR,CAA3B,KAAkG,MAAM,MAAN,EAAc,MAAd,EAAsB,IAAtB,CAA2B,EAAE,OAAO,EAAE,UAAU,MAAZ,EAAT,EAA3B;;AAElG,uBAAO,cAAP,CAAsB,IAAtB,EAA4B,KAA5B,EAAmC,MAAnC,EAA2C,MAA3C,EAAmD,UAAU,IAAV,EAAgB;AAC/D,2BAAO,cAAP,CAAsB,SAAtB,EAAiC,SAAjC,EAA4C,UAA5C,EAAwD,MAAxD;AACA,uBAAG,OAAH,EAAY,OAAO,yBAAP,CAAiC,KAAK,IAAL,CAAU,IAA3C,EAAiD,SAAjD,EAA4D,OAA5D,CAAZ;AACH,iBAHD;;;AAMA;AACH,aAhCD,MAgCO;AACH,yBAAS,SAAT,CAAmB,SAAnB,EAA8B,iBAA9B;AACA,yBAAS,SAAT,CAAmB,SAAnB,EAA8B,WAA9B;AACA,oBAAI,CAAC,OAAO,WAAP,CAAmB,UAAnB,EAA+B,OAA/B,CAAL,EAA8C,SAAS,gBAAT,CAA0B,SAA1B,EAAqC,cAArC;AAC9C,yBAAS,SAAT,CAAmB,SAAnB,EAA8B,gBAA9B;AACH;AACJ;;AAED,gBAAQ,GAAR,CAAY,yCAAZ;AACA,gBAAQ,GAAR,CAAY,aAAa,WAAzB;;AAEA,YAAI,CAAC,OAAO,WAAP,CAAmB,aAAnB,EAAkC,aAAa,WAA/C,CAAL,EAAkE;AAC9D,qBAAS,IAAT,CAAc,EAAE,MAAM,OAAR,EAAiB,SAAS,SAAS,WAAT,CAAqB,YAArB,CAA1B,EAAd;AACA,qBAAS,WAAT,CAAqB,SAArB,EAAgC,cAAhC,EAAgD,mBAAhD;AACA,eAAG,OAAH,EAAY,QAAZ;AACA;AACH;AACD,gBAAQ,GAAR,CAAY,6BAAZ;;;AAGA,YAAI,CAAC,OAAO,WAAP,CAAmB,cAAnB,EAAmC,aAAa,WAAhD,CAAD,IAAiE,CAAC,OAAO,WAAP,CAAmB,QAAnB,EAA6B,OAA7B,CAAtE,EAA6G;AACzG,uBAAW,SAAS,MAAT,CAAgB,OAAO,WAAP,CAAmB,SAAnB,EAA8B,MAA9B,CAAhB,CAAX;AACA,eAAG,OAAH,EAAY,QAAZ;AACA;AACH,SAJD,MAIO;AACH,gBAAI,OAAO,WAAP,CAAmB,cAAnB,EAAmC,aAAa,WAAhD,CAAJ,EAAkE,cAAc,aAAa,WAAb,CAAyB,YAAvC;;AAElE,gBAAI,sCAAsC,EAA1C;AACA,gBAAI,YAAY,MAAZ,GAAqB,CAAzB,EAA4B;AACxB,qBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,YAAY,MAAhC,EAAwC,GAAxC,EAA6C;AACzC,wBAAI,UAAU,YAAY,CAAZ,EAAe,WAAf,EAAd;AACA,wBAAI,qBAAqB,SAAS,gBAAT,CAA0B,OAA1B,IAAqC,SAAS,mBAAT,CAA6B,OAA7B,CAArC,GAA6E,SAAtG;AACA,wBAAI,sBAAsB,SAA1B,EAAqC;AACjC,4BAAI,2BAA2B,OAAO,IAAP,CAAY,kBAAZ,CAA/B;AACA,8DAAsC,oCAAoC,MAApC,CAA2C,wBAA3C,CAAtC;AACH;AACJ;AACJ;AACD,oBAAQ,GAAR,CAAY,SAAZ,EAAuB,mCAAvB;AACA,gBAAI,oCAAoC,MAApC,GAA6C,CAAjD,EAAoD;;AAEhD,oBAAI,iBAAiB,oCAAoC,MAAzD;AACA,oBAAI,iBAAiB,CAAjB,IAAsB,CAAC,OAAO,WAAP,CAAmB,gBAAnB,EAAqC,YAArC,CAA3B,EAA+E;AAC3E,6BAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,aAAT,CAAuB,cAAvB,CAAzB,EAAd;AACA,6BAAS,WAAT,CAAqB,SAArB,EAAgC,gBAAhC,EAAkD,KAAlD;AACH;;AAED,qBAAK,IAAI,CAAT,IAAc,mCAAd,EAAmD;AAC/C,wBAAI,0BAA0B,oCAAoC,CAApC,CAA9B;AACA,wBAAI,CAAC,OAAO,WAAP,CAAmB,uBAAnB,EAA4C,aAAa,WAAzD,CAAL,EAA4E;AACxE,gCAAQ,GAAR,CAAY,0BAAZ,EAAwC,UAAU,UAAV,GAAuB,uBAA/D;AACA,iCAAS,WAAT,CAAqB,SAArB,EAAgC,cAAhC,EAAgD,uBAAhD;AACA,4BAAI,UAAU,SAAS,gBAAT,CAA0B,uBAA1B,CAAd;AACA,gCAAQ,GAAR,CAAY,OAAZ;AACA,4BAAI,kBAAkB,QAAQ,iBAAR,CAAtB;AACA,4BAAI,kBAAkB,EAAtB;AACA,wCAAgB,QAAhB,IAA4B,eAA5B;;AAEA,4BAAI,QAAQ,MAAR,KAAmB,SAAvB,EAAkC;AAC9B,4CAAgB,SAAhB,IAA6B,QAAQ,WAAR,CAA7B;AACA,qCAAS,IAAT,CAAc,EAAE,MAAM,SAAR,EAAmB,SAAS,eAA5B,EAAd;AACH,yBAHD,MAGO,IAAI,QAAQ,MAAR,KAAmB,WAAvB,EAAoC;AACvC,4CAAgB,WAAhB,IAA+B,QAAQ,WAAR,CAA/B;AACA,4CAAgB,YAAhB,IAAgC,QAAQ,YAAR,CAAhC;AACA,qCAAS,IAAT,CAAc,EAAE,MAAM,WAAR,EAAqB,SAAS,eAA9B,EAAd;AACH;AACD,iCAAS,kBAAT,CAA4B,SAA5B,EAAuC,uBAAvC,EAAgE,SAAhE;AACA,2BAAG,OAAH,EAAY,QAAZ;AACA;AACH;AACJ;AACJ;AACJ;;AAED,gBAAQ,GAAR,CAAY,2BAAZ;AACA,YAAI,SAAS,SAAS,kBAAT,CAA4B,YAA5B,CAAb;AACA,YAAI,cAAc,OAAO,IAAP,CAAY,UAAZ,EAAwB,MAAxB,IAAkC,CAApD,EAAuD,aAAa,SAAb;AACvD,YAAI,aAAa,OAAO,IAAP,CAAY,SAAZ,EAAuB,MAAvB,IAAiC,CAAlD,EAAqD,YAAY,SAAZ;;;AAGrD,YAAI,eAAe,EAAnB;;AAEA,YAAI,YAAY,MAAZ,IAAsB,CAAtB,IAA2B,OAAO,WAAP,CAAmB,QAAnB,EAA6B,OAA7B,CAA/B,EAAsE;AAClE,gBAAI,YAAY,MAAZ,IAAsB,CAA1B,EAA6B,UAAU,YAAY,CAAZ,EAAe,WAAf,EAAV,CAA7B,KAAyE,UAAU,QAAQ,MAAR,CAAe,WAAf,GAA6B,IAA7B,EAAV;AACzE,gBAAI,OAAO,SAAS,mBAAT,CAA6B,OAA7B,IAAwC,SAAS,aAAT,CAAuB,OAAvB,CAAxC,GAA0E,SAArF;AACA,mBAAO,cAAP,CAAsB,IAAtB,EAA4B,UAA5B,EAAwC,MAAxC,EAAgD,MAAhD,EAAwD,UAAU,IAAV,EAAgB;AACpE,uBAAO,cAAP,CAAsB,SAAtB,EAAiC,SAAjC,EAA4C,UAA5C,EAAwD,MAAxD;AACA,mBAAG,OAAH,EAAY,OAAO,eAAP,CAAuB,KAAK,IAAL,CAAU,IAAjC,EAAuC,MAAvC,EAA+C,SAA/C,EAA0D,OAA1D,EAAmE,KAAnE,CAAZ;AACH,aAHD;AAIH,SAPD,MAOO,IAAI,YAAY,MAAZ,GAAqB,CAAzB,EAA4B;AAC/B,gBAAI,WAAW,YAAY,CAAZ,EAAe,WAAf,EAAf;AACA,gBAAI,WAAW,YAAY,CAAZ,EAAe,WAAf,EAAf;AACA,mBAAO,cAAP,CAAsB,IAAtB,EAA4B,UAA5B,EAAwC,MAAxC,EAAgD,MAAhD,EAAwD,UAAU,IAAV,EAAgB;AACpE,uBAAO,cAAP,CAAsB,SAAtB,EAAiC,SAAjC,EAA4C,UAA5C,EAAwD,MAAxD;AACA,+BAAe,aAAa,MAAb,CAAoB,OAAO,eAAP,CAAuB,KAAK,IAAL,CAAU,IAAjC,EAAuC,MAAvC,EAA+C,SAA/C,EAA0D,QAA1D,EAAoE,KAApE,CAApB,CAAf;AACA,uBAAO,cAAP,CAAsB,IAAtB,EAA4B,UAA5B,EAAwC,MAAxC,EAAgD,MAAhD,EAAwD,UAAU,IAAV,EAAgB;AACpE,2BAAO,cAAP,CAAsB,SAAtB,EAAiC,SAAjC,EAA4C,UAA5C,EAAwD,MAAxD;AACA,mCAAe,aAAa,MAAb,CAAoB,OAAO,eAAP,CAAuB,KAAK,IAAL,CAAU,IAAjC,EAAuC,MAAvC,EAA+C,SAA/C,EAA0D,QAA1D,EAAoE,KAApE,CAApB,CAAf;;AAEA,4BAAQ,GAAR,CAAY,aAAa,MAAzB;;AAEA,6BAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,qCAAzB,EAAd;AACA,wBAAI,mBAAmB,EAAvB;AACA,yBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,aAAa,MAAjC,EAAyC,GAAzC,EAA8C;AAC1C,4BAAI,MAAM,aAAa,CAAb,CAAV;AACA,4BAAI,IAAI,MAAJ,KAAe,MAAnB,EAA2B;AACvB,6CAAiB,IAAjB,CAAsB,IAAI,SAAJ,CAAtB;AACH;AACD,4BAAI,IAAI,MAAJ,KAAe,MAAnB,EAA2B,SAAS,IAAT,CAAc,GAAd;AAC9B;AACD,wBAAI,iBAAiB,wEAAwE,QAAxE,GAAmF,GAAnF,GAAyF,MAAzF,GAAkG,QAAvH;AACA,6BAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,cAAzB,EAAd;AACA,wBAAI,gBAAgB,OAAO,mBAAP,CAA2B,gBAA3B,EAA6C,QAA7C,EAAuD,QAAvD,CAApB;;AAEA,wBAAI,eAAe,SAAS,oBAAT,CAA8B,QAA9B,IAA0C,SAAS,oBAAT,CAA8B,QAA9B,CAA1C,GAAoF,EAAvG;AACA,mCAAe,aAAa,MAAb,CAAoB,SAAS,oBAAT,CAA8B,QAA9B,IAA0C,SAAS,oBAAT,CAA8B,QAA9B,CAA1C,GAAoF,EAAxG,CAAf;AACA,6BAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,aAAzB,EAAwC,oBAAoB,YAA5D,EAAd;;;AAGA,uBAAG,OAAH,EAAY,QAAZ;AACH,iBAzBD;AA0BH,aA7BD;AA8BH;;;AAGJ,KApbW;AAqbZ,KAAC,eAAD,EAAkB,SAAlB,EAA6B,OAA7B,EAAsC,MAAtC,EAA8C,EAA9C,EAAkD;;;AAG9C,gBAAQ,GAAR,CAAY,gCAAZ;AACA,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,YAAI,YAAY,EAAhB;AACA,YAAI,aAAa,EAAjB;AACA,YAAI,SAAS,EAAb;AACA,YAAI,KAAJ;AACA,YAAI,mBAAJ;;AAEA,YAAI,uBAAuB,OAAO,IAAP,CAAY,OAAZ,CAA3B;AACA,YAAI,gBAAgB,CAAC,UAAD,EAAa,UAAb,EAAyB,iBAAzB,EAA4C,iBAA5C,EAA+D,UAA/D,EAA2E,UAA3E,EAAuF,cAAvF,EAAuG,UAAvG,EAAmH,qBAAnH,EAA0I,cAA1I,EAA0J,eAA1J,EAA2K,mBAA3K,EAAgM,aAAhM,EAA+M,gBAA/M,EAAiO,WAAjO,EAA8O,UAA9O,CAApB;;AAEA,wBAAgB,cAAc,MAAd,CAAqB,UAAU,CAAV,EAAa;AAC9C,mBAAO,qBAAqB,OAArB,CAA6B,CAA7B,KAAmC,CAAC,CAA3C;AACH,SAFe,CAAhB;;AAIA,YAAI,MAAM,QAAQ,cAAc,CAAd,CAAR,CAAV;AACA,cAAM,IAAI,WAAJ,EAAN;;AAEA,oBAAY,SAAS,mBAAT,CAA6B,GAA7B,IAAoC,SAAS,aAAT,CAAuB,GAAvB,CAApC,GAAkE,SAA9E;AACA,gBAAQ,GAAR,CAAY,eAAZ;AACA,YAAI,kBAAkB,aAAa,eAAb,CAA6B,UAAnD;AACA,YAAI,cAAc,aAAa,eAAb,CAA6B,MAA/C;AACA,YAAI,SAAS,OAAO,YAAP,CAAoB,SAApB,EAA+B,UAA/B,EAA2C,MAA3C,EAAmD,eAAnD,EAAoE,WAApE,CAAb;AACA,qBAAa,OAAO,OAAP,CAAb;AACA,iBAAS,OAAO,QAAP,CAAT;;AAEA,YAAI,cAAc,OAAO,IAAP,CAAY,UAAZ,EAAwB,MAAxB,IAAkC,CAApD,EAAuD,aAAa,SAAb;AACvD,YAAI,aAAa,OAAO,IAAP,CAAY,SAAZ,EAAuB,MAAvB,IAAiC,CAAlD,EAAqD,YAAY,SAAZ;;AAErD,YAAI,SAAS,SAAS,kBAAT,CAA4B,YAA5B,CAAb;AACA,eAAO,cAAP,CAAsB,SAAtB,EAAiC,UAAjC,EAA6C,MAA7C,EAAqD,MAArD,EAA6D,UAAU,IAAV,EAAgB;AACzE,mBAAO,cAAP,CAAsB,SAAtB,EAAiC,SAAjC,EAA4C,UAA5C,EAAwD,MAAxD;AACA,eAAG,OAAH,EAAY,OAAO,yBAAP,CAAiC,KAAK,IAAL,CAAU,IAA3C,EAAiD,SAAjD,EAA4D,GAA5D,CAAZ;AACH,SAHD;AAIH,KA1dW;AA2dZ,KAAC,eAAD,EAAkB,SAAlB,EAA6B,OAA7B,EAAsC,MAAtC,EAA8C,EAA9C,EAAkD;AAC9C,YAAI,aAAa,QAAQ,GAAzB;AACA,YAAI,QAAQ,OAAZ;AACA,YAAI,WAAW,EAAf;;AAEA,eAAO,uBAAP,CAA+B,KAA/B,EAAsC,UAAtC,EAAkD,UAAU,MAAV,EAAkB;;AAEhE,gBAAI,QAAQ,SAAS,MAAT,CAAZ;AACA,gBAAI,OAAO,SAAS,aAAT,CAAuB,SAAvB,CAAX;AACA,gBAAI,QAAQ,SAAZ;AACA,gBAAI,SAAS,EAAE,SAAS,EAAE,SAAS,EAAE,OAAO,QAAQ,IAAjB,EAAuB,OAAO,QAAQ,IAAtC,EAAX,EAAX,EAAb;AACA,gBAAI,SAAS,SAAS,kBAAT,CAA4B,YAA5B,CAAb;AACA,mBAAO,cAAP,CAAsB,IAAtB,EAA4B,KAA5B,EAAmC,MAAnC,EAA2C,MAA3C,EAAmD,UAAU,IAAV,EAAgB;;AAE/D,oBAAI,OAAO,KAAK,IAAL,CAAU,IAArB;AACA,oBAAI,KAAK,MAAL,IAAe,CAAnB,EAAsB;AAClB,6BAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,cAArB,CAAzB,EAAd;AACA,uBAAG,OAAH,EAAY,QAAZ;AACA;AACH;;AAED,oBAAI,UAAU,IAAd,EAAoB;AAChB,2BAAO,KAAK,KAAL,CAAW,CAAX,EAAc,CAAd,CAAP;AACH,iBAFD,MAEO,IAAI,UAAU,SAAd,EAAyB;AAC5B,2BAAO,OAAO,eAAP,CAAuB,IAAvB,CAAP;AACH;;;AAGD,yBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,IAAzB,EAA+B,oBAAoB,EAAnD,EAAd;;AAEA,yBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,WAArB,CAAzB,EAAd;AACA,mBAAG,OAAH,EAAY,QAAZ;AACH,aApBD;AAqBH,SA5BD;AA6BH,KA7fW;AA8fZ,KAAC,kBAAD,EAAqB,SAArB,EAAgC,OAAhC,EAAyC,MAAzC,EAAiD,EAAjD,EAAqD;;AAEjD,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,YAAI,WAAW,EAAf;AACA,YAAI,CAAC,OAAO,WAAP,CAAmB,aAAnB,EAAkC,aAAa,WAA/C,CAAL,EAAkE;AAC9D,qBAAS,IAAT,CAAc,EAAE,MAAM,OAAR,EAAiB,SAAS,SAAS,WAAT,CAAqB,mBAArB,CAA1B,EAAd;AACA,qBAAS,WAAT,CAAqB,SAArB,EAAgC,cAAhC,EAAgD,mBAAhD;AACA,eAAG,OAAH,EAAY,QAAZ;AACA;AACH;AACD,YAAI,CAAC,OAAO,WAAP,CAAmB,KAAnB,EAA0B,OAA1B,CAAL,EAAyC;AACrC,gBAAI,QAAQ,MAAR,IAAkB,QAAtB,EAAgC,SAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,QAArB,CAAzB,EAAd,EAAhC,KAA8G,IAAI,QAAQ,MAAR,IAAkB,MAAtB,EAA8B,SAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,OAArB,CAAzB,EAAd,EAA9B,KAA2G,SAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,KAArB,CAAzB,EAAd;AACzN,qBAAS,WAAT,CAAqB,SAArB,EAAgC,cAAhC,EAAgD,gBAAhD;AACA,eAAG,OAAH,EAAY,QAAZ;AACA;AACH;AACD,YAAI,IAAJ;AACA,YAAI,QAAQ,MAAR,IAAkB,QAAtB,EAAgC,OAAO,SAAS,aAAT,CAAuB,cAAvB,CAAP,CAAhC,KAAmF,IAAI,QAAQ,MAAR,IAAkB,MAAtB,EAA8B,OAAO,SAAS,aAAT,CAAuB,YAAvB,CAAP,CAA9B,KAA+E,IAAI,QAAQ,MAAR,IAAkB,KAAtB,EAA6B,OAAO,SAAS,aAAT,CAAuB,MAAvB,CAAP;;AAE/L,YAAI,QAAQ,SAAZ;AACA,YAAI,cAAc,EAAlB;AACA,YAAI,qBAAqB,EAAE,SAAS,EAAE,SAAS,EAAE,OAAO,aAAa,WAAb,CAAyB,WAAlC;AACnC,2BAAO,aAAa,WAAb,CAAyB,SADG,EAAX,EAAX,EAAzB;AAEA,oBAAY,IAAZ,CAAiB,kBAAjB;;AAEA,YAAI,QAAQ,GAAR,GAAc,EAAlB,EAAsB;AAClB,gBAAI,aAAa,EAAE,SAAS,EAAE,cAAc,EAAE,OAAO,CAAT,EAAhB,EAAX,EAAjB;AACA,wBAAY,IAAZ,CAAiB,UAAjB;AACA,gBAAI,qBAAqB,EAAE,SAAS,EAAE,eAAe,EAAE,MAAM,GAAR,EAAjB,EAAX,EAAzB;AACA,wBAAY,IAAZ,CAAiB,kBAAjB;AACA,oBAAQ,EAAE,MAAM,EAAE,YAAY,CAAC,EAAE,SAAS,EAAE,oBAAoB,IAAtB,EAAX,EAAD,CAAd,EAAR,EAAR;AACH;AACD,YAAI,SAAS,EAAb;AACA,eAAO,KAAP,IAAgB,WAAhB;;AAEA,YAAI,SAAS,SAAS,kBAAT,CAA4B,YAA5B,CAAb;AACA,gBAAQ,GAAR,CAAY,IAAZ,EAAkB,KAAlB,EAAyB,MAAzB;AACA,eAAO,cAAP,CAAsB,IAAtB,EAA4B,KAA5B,EAAmC,MAAnC,EAA2C,MAA3C,EAAmD,UAAU,IAAV,EAAgB;AAC/D,gBAAI,OAAO,KAAK,IAAL,CAAU,IAArB;AACA,gBAAI,KAAK,MAAL,IAAe,CAAnB,EAAsB;AAClB,yBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,cAArB,CAAzB,EAAd;AACA,mBAAG,OAAH,EAAY,QAAZ;AACA;AACH;AACD,gBAAI,UAAU,IAAd,EAAoB;AAChB,uBAAO,KAAK,KAAL,CAAW,CAAX,EAAc,CAAd,CAAP;AACA,yBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,IAAzB,EAAd;AACH,aAHD,MAGO,IAAI,UAAU,SAAd,EAAyB;AAC5B,oBAAI,UAAU,EAAd;AACA,qBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,MAAzB,EAAiC,GAAjC,EAAsC,QAAQ,IAAR,CAAa,KAAK,CAAL,EAAQ,QAAR,CAAb;AACtC,yBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,OAAzB,EAAkC,oBAAoB,EAAtD,EAAd;AACH;;AAED,eAAG,OAAH,EAAY,QAAZ;AACH,SAjBD;AAkBH,KArjBW;;;AAwjBZ,KAAC,gBAAD,EAAmB,SAAnB,EAA8B,OAA9B,EAAuC,MAAvC,EAA+C,EAA/C,EAAmD;AAC/C,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,gBAAQ,GAAR,CAAY,sBAAZ;AACA,YAAI,GAAJ;AACA,YAAI,OAAO,WAAP,CAAmB,UAAnB,EAA+B,OAA/B,CAAJ,EAA6C,MAAM,QAAQ,QAAd,CAA7C,KAAyE,IAAI,OAAO,WAAP,CAAmB,WAAnB,EAAgC,OAAhC,CAAJ,EAA8C,MAAM,QAAQ,SAAd,CAA9C,KAA2E;AAChJ,gBAAI,UAAU,IAAd,EAAoB,MAAM,OAAN,CAApB,KAAuC,MAAM,YAAN;AAC1C;;AAED,YAAI,cAAc,CAAC,QAAQ,IAAT,EAAe,QAAQ,IAAvB,CAAlB;AACA,gBAAQ,GAAR,CAAY,aAAa,IAAb,GAAoB,GAApB,GAA0B,aAAa,IAAnD;AACA,YAAI,WAAW,EAAf;AACA,YAAI,SAAS,CAAC,YAAD,CAAb;AACA,gBAAQ,GAAR,CAAY,YAAZ;AACA,YAAI,mBAAmB,SAAS,kBAAT,CAA4B,GAA5B,CAAvB;AACA,gBAAQ,GAAR,CAAY,gBAAZ;AACA,iBAAS,OAAO,MAAP,CAAc,gBAAd,CAAT;;AAEA,eAAO,eAAP,CAAuB,MAAvB,EAA+B,WAA/B,EAA4C,UAAU,cAAV,EAA0B;;AAElE,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,SAArB,CAAzB,EAAd;AACA,gBAAI,UAAU,IAAd,EAAoB;;AAEhB,yBAAS,IAAT,CAAc;AACV,0BAAM,MADI;AAEV,6BAAS,OAAO,mBAAP,CAA2B,eAAe,CAAf,CAA3B,EAA8C,MAA9C,EAAsD,CAAtD,EAAyD,OAAO,MAAhE;AAFC,iBAAd;AAIA,yBAAS,IAAT,CAAc;AACV,0BAAM,MADI;AAEV,6BAAS,OAAO,mBAAP,CAA2B,eAAe,CAAf,CAA3B,EAA8C,MAA9C,EAAsD,CAAtD,EAAyD,OAAO,MAAhE;AAFC,iBAAd;AAIH,aAVD,MAUO,IAAI,UAAU,SAAd,EAAyB,IAAI,OAAO,YAAX,EAAyB;AACrD,yBAAS,IAAT,CAAc;AACV,0BAAM,MADI;AAEV,6BAAS,OAAO,mBAAP,CAA2B,eAAe,CAAf,CAA3B,EAA8C,MAA9C,EAAsD,CAAtD,EAAyD,OAAO,MAAhE;AAFC,iBAAd;AAIA,yBAAS,IAAT,CAAc;AACV,0BAAM,MADI;AAEV,6BAAS,OAAO,mBAAP,CAA2B,eAAe,CAAf,CAA3B,EAA8C,MAA9C,EAAsD,CAAtD,EAAyD,OAAO,MAAhE;AAFC,iBAAd;AAIH;AACD,qBAAS,IAAT,CAAc,EAAE,MAAM,SAAR,EAAmB,SAAS,WAA5B,EAAd;;AAEA,eAAG,OAAH,EAAY,QAAZ;AACH,SA1BD;AA2BH,KApmBW;AAqmBZ,KAAC,kBAAD,EAAqB,SAArB,EAAgC,OAAhC,EAAyC,MAAzC,EAAiD,EAAjD,EAAqD;;AAEjD,YAAI,cAAc,CAAC,QAAQ,IAAT,EAAe,QAAQ,IAAvB,CAAlB;AACA,YAAI,OAAJ;AACA,YAAI,OAAO,WAAP,CAAmB,UAAnB,EAA+B,OAA/B,CAAJ,EAA6C,UAAU,QAAQ,QAAlB,CAA7C,KAA6E,IAAI,OAAO,WAAP,CAAmB,WAAnB,EAAgC,OAAhC,CAAJ,EAA8C,UAAU,QAAQ,SAAlB,CAA9C,KAA+E,UAAU,QAAV;AAC5J,eAAO,aAAP,CAAqB,OAArB,EAA8B,WAA9B,EAA2C,UAAU,QAAV,EAAoB;;AAE3D,eAAG,OAAH,EAAY,QAAZ;AACH,SAHD;AAIH,KA9mBW;AA+mBZ,KAAC,eAAD,EAAkB,SAAlB,EAA6B,OAA7B,EAAsC,MAAtC,EAA8C,EAA9C,EAAkD;;AAE9C,YAAI,cAAc,CAAC,QAAQ,GAAT,CAAlB;AACA,YAAI,SAAS,SAAS,kBAAT,CAA4B,YAA5B,CAAb;AACA,YAAI,WAAW,EAAf;;AAEA,eAAO,eAAP,CAAuB,MAAvB,EAA+B,WAA/B,EAA4C,UAAU,WAAV,EAAuB;AAC/D,oBAAQ,GAAR,CAAY,WAAZ;AACA,gBAAI,gBAAgB,WAAW,YAAY,CAAZ,EAAe,eAAf,CAAX,CAApB;AACA,gBAAI,QAAQ,YAAY,CAAZ,EAAe,OAAf,CAAZ;AACA,gBAAI,QAAQ,SAAS,aAAT,CAAuB,OAAvB,CAAZ;AACA,gBAAI,QAAQ,SAAZ;AACA,gBAAI,SAAS,EAAE,OAAO,CAAC,EAAE,SAAS,EAAE,iBAAiB,EAAE,OAAO,aAAT,EAAnB,EAAX,EAAD,CAAT,EAAb;;AAEA,qBAAS,SAAS,kBAAT,CAA4B,YAA5B,CAAT;AACA,mBAAO,cAAP,CAAsB,KAAtB,EAA6B,KAA7B,EAAoC,MAApC,EAA4C,MAA5C,EAAoD,UAAU,IAAV,EAAgB;AAChE,oBAAI,OAAO,KAAK,IAAL,CAAU,IAArB;AACA,oBAAI,KAAK,MAAL,IAAe,CAAnB,EAAsB;AAClB,6BAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,cAArB,CAAzB,EAAd;AACA,uBAAG,OAAH,EAAY,QAAZ;AACA;AACH;AACD,uBAAO,cAAP,CAAsB,SAAtB,EAAiC,KAAjC,EAAwC,KAAxC,EAA+C,MAA/C;AACA,oBAAI,UAAU,IAAd,EAAoB;AAChB,2BAAO,KAAK,KAAL,CAAW,CAAX,EAAc,CAAd,CAAP;AACA,6BAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,IAAzB,EAAd;AACH,iBAHD,MAGO,IAAI,UAAU,SAAd,EAAyB;AAC5B,wBAAI,UAAU,EAAd;AACA,yBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,KAAK,MAAzB,EAAiC,GAAjC,EAAsC,QAAQ,IAAR,CAAa,KAAK,CAAL,EAAQ,QAAR,CAAb;AACtC,6BAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,OAAzB,EAAkC,oBAAoB,EAAtD,EAAd;AACH;;AAED,mBAAG,OAAH,EAAY,QAAZ;AACH,aAlBD;AAmBH,SA5BD;AA6BH,KAlpBW;;;AAqpBZ,KAAC,sBAAD,EAAyB,SAAzB,EAAoC,OAApC,EAA6C,MAA7C,EAAqD,EAArD,EAAyD;AACrD,YAAI,WAAW,EAAf;AACA,YAAI,aAAa,QAAQ,GAAzB;AACA,YAAI,YAAY,QAAQ,SAAR,CAAkB,WAAlB,EAAhB;AACA,YAAI,MAAM,SAAS,aAAT,CAAuB,SAAvB,IAAoC,SAAS,QAAT,CAAkB,SAAlB,CAApC,GAAmE,SAA7E;AACA,YAAI,OAAO,IAAX,EAAiB;AACb,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,QAArB,CAAzB,EAAd;AACA,eAAG,OAAH,EAAY,QAAZ;AACA;AACH;;AAED,eAAO,uBAAP,CAA+B,GAA/B,EAAoC,UAApC,EAAgD,UAAU,IAAV,EAAgB;AAC5D,gBAAI,QAAQ,SAAS,YAAT,CAAsB,GAAtB,IAA6B,SAAS,UAAT,CAAoB,GAApB,CAA7B,GAAwD,EAApE;AACA,gBAAI,mBAAmB,SAAS,aAAT,CAAuB,SAAvB,IAAoC,SAAS,YAAT,CAAsB,SAAtB,CAApC,GAAuE,SAA9F;AACA,gBAAI,WAAW,OAAO,GAAP,GAAa,KAAb,GAAqB,IAApC;;AAEA,oBAAQ,GAAR,CAAY,GAAZ;AACA,gBAAI,SAAS,2BAAT,CAAqC,GAArC,CAAJ,EAA+C,SAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,iCAAT,CAA2C,GAA3C,EAAgD,OAAhD,CAAzB,EAAd;AAC/C,gBAAI,QAAQ,SAAR,IAAqB,QAAzB,EAAmC;AAC/B,oBAAI,SAAS,WAAW,QAAX,CAAb;AACA,yBAAS,OAAO,OAAP,CAAe,CAAf,CAAT;AACA,oBAAI,UAAU,SAAS,aAAT,CAAuB,QAAQ,GAA/B,EAAoC,MAApC,CAAd;AACA,yBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,OAAzB,EAAd;AACH,aALD,MAKO,SAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,QAAzB,EAAd;;AAEP,gBAAI,oBAAoB,SAAxB,EAAmC,SAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,gBAAzB,EAAd;;AAEnC,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,CAAC,QAAQ,GAAT,CAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SAnBD;AAoBH,KAprBW;AAqrBZ,KAAC,oBAAD,EAAuB,SAAvB,EAAkC,OAAlC,EAA2C,MAA3C,EAAmD,EAAnD,EAAuD;;AAEnD,YAAI,cAAc,CAAC,QAAQ,GAAT,CAAlB;AACA,YAAI,WAAW,EAAf;AACA,YAAI,SAAS,CAAC,YAAD,CAAb;AACA,iBAAS,OAAO,MAAP,CAAc,SAAS,kBAAT,CAA4B,KAA5B,CAAd,CAAT;AACA,eAAO,eAAP,CAAuB,MAAvB,EAA+B,WAA/B,EAA4C,UAAU,WAAV,EAAuB;AAC/D,gBAAI,SAAS,OAAO,mBAAP,CAA2B,YAAY,CAAZ,CAA3B,EAA2C,MAA3C,EAAmD,CAAnD,EAAsD,OAAO,MAA7D,CAAb;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,MAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,WAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SAND;AAOH,KAlsBW;AAmsBZ,KAAC,YAAD,EAAe,SAAf,EAA0B,OAA1B,EAAmC,MAAnC,EAA2C,EAA3C,EAA+C;;AAE3C,gBAAQ,GAAR,CAAY,qBAAZ;AACA,YAAI,OAAJ;AACA,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,YAAI,OAAO,WAAP,CAAmB,UAAnB,EAA+B,OAA/B,CAAJ,EAA6C,UAAU,QAAQ,QAAlB,CAA7C,KAA6E,IAAI,OAAO,WAAP,CAAmB,WAAnB,EAAgC,OAAhC,CAAJ,EAA8C,UAAU,QAAQ,SAAlB,CAA9C,KAA+E,UAAU,KAAV;AAC5J,YAAI,cAAc,CAAC,QAAQ,GAAT,CAAlB;AACA,YAAI,WAAW,EAAf;AACA,YAAI,SAAS,CAAC,YAAD,CAAb;AACA,iBAAS,OAAO,MAAP,CAAc,SAAS,kBAAT,CAA4B,OAA5B,CAAd,CAAT;AACA,gBAAQ,GAAR,CAAY,UAAZ,EAAwB,MAAxB;AACA,eAAO,eAAP,CAAuB,MAAvB,EAA+B,WAA/B,EAA4C,UAAU,WAAV,EAAuB;AAC/D,gBAAI,SAAS,OAAO,mBAAP,CAA2B,YAAY,CAAZ,CAA3B,EAA2C,MAA3C,EAAmD,CAAnD,EAAsD,OAAO,MAA7D,CAAb;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,MAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,WAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SAND;AAOH,KArtBW;AAstBZ,KAAC,UAAD,EAAa,SAAb,EAAwB,OAAxB,EAAiC,MAAjC,EAAyC,EAAzC,EAA6C;AACzC,gBAAQ,YAAR,EAAsB,SAAtB,EAAiC,OAAjC,EAA0C,MAA1C,EAAkD,EAAlD;AACH,KAxtBW;AAytBZ,KAAC,eAAD,EAAkB,SAAlB,EAA6B,OAA7B,EAAsC,MAAtC,EAA8C,EAA9C,EAAkD;AAC9C,YAAI,SAAS,CAAC,YAAD,EAAe,cAAf,EAA+B,aAA/B,EAA8C,WAA9C,CAAb;AACA,YAAI,WAAW,EAAf;AACA,eAAO,eAAP,CAAuB,MAAvB,EAA+B,CAAC,QAAQ,GAAT,CAA/B,EAA8C,UAAU,WAAV,EAAuB;AACjE,oBAAQ,GAAR,CAAY,YAAY,CAAZ,CAAZ;AACA,gBAAI,SAAS,OAAO,mBAAP,CAA2B,YAAY,CAAZ,CAA3B,EAA2C,MAA3C,EAAmD,CAAnD,EAAsD,OAAO,MAA7D,CAAb;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,MAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,CAAC,QAAQ,GAAT,CAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SAPD;AAQH,KApuBW;AAquBZ,KAAC,YAAD,EAAe,SAAf,EAA0B,OAA1B,EAAmC,MAAnC,EAA2C,EAA3C,EAA+C;;AAE3C,YAAI,OAAJ;AACA,YAAI,OAAO,WAAP,CAAmB,UAAnB,EAA+B,OAA/B,CAAJ,EAA6C;AACzC,sBAAU,QAAQ,QAAR,CAAiB,WAAjB,KAAiC,SAA3C;AACH,SAFD,MAEO;AACH,sBAAU,SAAV;AACH;;AAED,YAAI,WAAW,EAAf;AACA,YAAI,aAAa,QAAQ,GAAzB;AACA,YAAI,MAAM,SAAS,aAAT,CAAuB,OAAvB,IAAkC,SAAS,QAAT,CAAkB,OAAlB,CAAlC,GAA+D,SAAzE;AACA,YAAI,OAAO,SAAX,EAAsB;AAClB,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,QAArB,CAAzB,EAAd;AACA,eAAG,OAAH,EAAY,QAAZ;AACA;AACH;;AAED,eAAO,uBAAP,CAA+B,GAA/B,EAAoC,UAApC,EAAgD,UAAU,IAAV,EAAgB;;AAE5D,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,IAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,CAAC,QAAQ,GAAT,CAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SAND;AAOH,KA9vBW;AA+vBZ,KAAC,WAAD,EAAc,SAAd,EAAyB,OAAzB,EAAkC,MAAlC,EAA0C,EAA1C,EAA8C;AAC1C,YAAI,aAAa,QAAQ,GAAzB;AACA,gBAAQ,GAAR,CAAY,6BAAZ;AACA,eAAO,uBAAP,CAA+B,gBAA/B,EAAiD,UAAjD,EAA6D,UAAU,IAAV,EAAgB;AACzE,gBAAI,SAAS,IAAb;AACA,gBAAI,WAAW,EAAf;;AAEA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,MAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,CAAC,QAAQ,GAAT,CAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SARD;AASH,KA3wBW;AA4wBZ,KAAC,mBAAD,EAAsB,SAAtB,EAAiC,OAAjC,EAA0C,MAA1C,EAAkD,EAAlD,EAAsD;AAClD,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,YAAI,WAAW,EAAf;AACA,YAAI,uBAAuB,OAAO,IAAP,CAAY,OAAZ,CAA3B;AACA,YAAI,qBAAqB,CAAC,UAAD,EAAa,iBAAb,EAAgC,iBAAhC,EAAmD,UAAnD,EAA+D,UAA/D,EAA2E,cAA3E,EAA2F,UAA3F,EAAuG,qBAAvG,EAA8H,cAA9H,EAA8I,eAA9I,EAA+J,mBAA/J,EAAoL,aAApL,EAAmM,gBAAnM,EAAqN,WAArN,CAAzB;;AAEA,6BAAqB,mBAAmB,MAAnB,CAA0B,UAAU,CAAV,EAAa;AACxD,mBAAO,qBAAqB,OAArB,CAA6B,CAA7B,KAAmC,CAAC,CAA3C;AACH,SAFoB,CAArB;AAGA,YAAI,SAAJ;AACA,YAAI,mBAAmB,MAAnB,IAA6B,CAAjC,EAAoC;AAChC,gBAAI,MAAM,mBAAmB,CAAnB,CAAV;AACA,gBAAI,QAAQ,QAAQ,mBAAmB,CAAnB,CAAR,CAAZ;AACA,wBAAY,KAAZ;AACH;;AAED,YAAI,OAAO,WAAP,CAAmB,OAAnB,EAA4B,OAA5B,CAAJ,EAA0C;AACtC,kBAAM,SAAS,QAAT,CAAkB,QAAQ,SAAR,CAAkB,WAAlB,EAAlB,CAAN;AACA,oBAAQ,QAAQ,kBAAhB;AACA,wBAAY,IAAZ;AACH;;AAED,YAAI,SAAS,CAAC,YAAD,EAAe,GAAf,CAAb;AACA,YAAI,MAAJ;;AAEA,eAAO,eAAP,CAAuB,MAAvB,EAA+B,CAAC,QAAQ,GAAT,CAA/B,EAA8C,UAAU,WAAV,EAAuB;;AAEjE,oBAAQ,GAAR,CAAY,aAAZ,EAA2B,WAA3B;AACA,gBAAI,SAAJ,EAAe;AACX,oBAAI,SAAS,SAAS,YAAY,CAAZ,EAAe,GAAf,EAAoB,CAApB,CAAT,CAAb;AACA,wBAAQ,SAAS,KAAT,CAAR;AACA,wBAAQ,GAAR,CAAY,OAAO,MAAnB,EAA2B,OAAO,KAAlC;AACA,oBAAI,UAAU,KAAd,EAAqB,SAAS,KAAT,CAArB,KAAyC,SAAS,IAAT;AAC5C,aALD,MAKO;AACH,oBAAI,SAAS,YAAY,CAAZ,EAAe,GAAf,EAAoB,CAApB,EAAuB,WAAvB,EAAb;AACA,wBAAQ,MAAM,WAAN,EAAR;AACA,oBAAI,OAAO,OAAP,CAAe,KAAf,IAAwB,CAAC,CAA7B,EAAgC,SAAS,KAAT,CAAhC,KAAoD,SAAS,IAAT;AACvD;;AAED,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,MAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,CAAC,QAAQ,GAAT,CAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SAlBD;AAmBH,KAxzBW;AAyzBZ,KAAC,cAAD,EAAiB,SAAjB,EAA4B,OAA5B,EAAqC,MAArC,EAA6C,EAA7C,EAAiD;;AAE7C,YAAI,YAAJ;AACA,YAAI,QAAQ,SAAR,IAAqB,UAAzB,EAAqC,eAAe,CAAC,yBAAD,EAA4B,wBAA5B,CAAf,CAArC,KAA+G,IAAI,QAAQ,SAAR,IAAqB,QAAzB,EAAmC,eAAe,CAAC,uBAAD,EAA0B,sBAA1B,CAAf;;AAElJ,eAAO,WAAP,CAAmB,QAAQ,SAA3B,EAAsC,YAAtC,EAAoD,QAAQ,GAA5D,EAAiE,UAAU,IAAV,EAAgB;AAC7E,gBAAI,SAAS,QAAQ,SAAR,KAAsB,QAAtB,GAAiC,KAAK,IAAL,CAAU,IAAV,CAAe,CAAf,EAAkB,QAAlB,EAA4B,aAAa,CAAb,CAA5B,EAA6C,CAA7C,CAAjC,GAAmF,KAAK,IAAL,CAAU,IAAV,CAAe,CAAf,EAAkB,QAAlB,EAA4B,aAAa,CAAb,CAA5B,EAA6C,CAA7C,CAAhG;AACA,gBAAI,UAAU,CAAd,EAAiB,SAAS,SAAS,WAAT,CAAqB,UAArB,CAAT;AACjB,qBAAS,QAAQ,SAAR,GAAoB,eAApB,GAAsC,QAAQ,GAA9C,GAAoD,MAApD,GAA6D,MAAtE;AACA,gBAAI,WAAW,EAAf;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,MAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,CAAC,QAAQ,GAAT,CAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SATD;AAUH,KAx0BW;AAy0BZ,KAAC,UAAD,EAAa,SAAb,EAAwB,OAAxB,EAAiC,MAAjC,EAAyC,EAAzC,EAA6C;;AAEzC,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,eAAO,uBAAP,CAA+B,cAA/B,EAA+C,QAAQ,GAAvD,EAA4D,UAAU,IAAV,EAAgB;AACxE,gBAAI,WAAW,EAAf;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,IAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,CAAC,QAAQ,GAAT,CAAxB,EAAd;AACzB,eAAG,OAAH,EAAY,QAAZ;AACH,SALD;AAMH,KAl1BW;AAm1BZ,KAAC,aAAD,EAAgB,SAAhB,EAA2B,OAA3B,EAAoC,MAApC,EAA4C,EAA5C,EAAgD;AAC5C,eAAO,uBAAP,CAA+B,MAA/B,EAAuC,QAAQ,GAA/C,EAAoD,UAAU,IAAV,EAAgB;AAChE,gBAAI,WAAW,EAAf;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,IAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,CAAC,QAAQ,GAAT,CAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SAND;AAOH,KA31BW;AA41BZ,KAAC,aAAD,EAAgB,SAAhB,EAA2B,OAA3B,EAAoC,MAApC,EAA4C,EAA5C,EAAgD;AAC5C,eAAO,uBAAP,CAA+B,MAA/B,EAAuC,QAAQ,GAA/C,EAAoD,UAAU,IAAV,EAAgB;AAChE,gBAAI,WAAW,EAAf;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,IAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,CAAC,QAAQ,GAAT,CAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SAND;AAOH,KAp2BW;AAq2BZ,KAAC,YAAD,EAAe,SAAf,EAA0B,OAA1B,EAAmC,MAAnC,EAA2C,EAA3C,EAA+C;AAC3C,YAAI,WAAW,EAAf;AACA,YAAI,SAAS,CAAC,MAAD,EAAS,MAAT,EAAiB,YAAjB,CAAb;AACA,eAAO,eAAP,CAAuB,MAAvB,EAA+B,CAAC,QAAQ,GAAT,CAA/B,EAA8C,UAAU,WAAV,EAAuB;;AAEjE,gBAAI,OAAO,aAAa,YAAY,CAAZ,EAAe,MAAf,EAAuB,CAAvB,CAAxB;AACA,gBAAI,OAAO,aAAa,YAAY,CAAZ,EAAe,MAAf,EAAuB,CAAvB,CAAxB;AACA,gBAAI,WAAW,EAAf;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,IAAzB,EAAd;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,IAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,CAAC,QAAQ,GAAT,CAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SAVD;AAWH,KAn3BW;AAo3BZ,KAAC,YAAD,EAAe,SAAf,EAA0B,OAA1B,EAAmC,MAAnC,EAA2C,EAA3C,EAA+C;AAC3C,YAAI,WAAW,EAAf;AACA,YAAI,aAAa,QAAQ,GAAzB;AACA,YAAI,MAAM,aAAV;AACA,YAAI,OAAO,IAAX,EAAiB;AACb,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,QAArB,CAAzB,EAAd;AACA,eAAG,OAAH,EAAY,QAAZ;AACA;AACH;;AAED,eAAO,uBAAP,CAA+B,GAA/B,EAAoC,UAApC,EAAgD,UAAU,IAAV,EAAgB;AAC5D,oBAAQ,GAAR,CAAY,IAAZ;;AAEA,gBAAI,WAAW,OAAO,MAAtB;;AAEA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,QAAzB,EAAd;AACA,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,KAAR,EAAe,SAAS,CAAC,QAAQ,GAAT,CAAxB,EAAd;;AAEzB,eAAG,OAAH,EAAY,QAAZ;AACH,SATD;AAUH,KAx4BW;;;AA24BZ,KAAC,sBAAD,EAAyB,SAAzB,EAAoC,OAApC,EAA6C,MAA7C,EAAqD,EAArD,EAAyD;AACrD,YAAI,cAAc,EAAlB;AACA,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,YAAI,aAAa,aAAa,iBAAb,CAAjB;AACA,aAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,WAAW,MAA/B,EAAuC,GAAvC,EAA4C,YAAY,IAAZ,CAAiB,WAAW,CAAX,EAAc,QAAd,EAAwB,YAAxB,EAAsC,CAAtC,CAAjB;AAC5C,YAAI,WAAW,EAAf;AACA,YAAI,YAAY,QAAQ,SAAR,CAAkB,WAAlB,EAAhB;AACA,gBAAQ,GAAR,CAAY,SAAZ;AACA,YAAI,MAAM,SAAS,aAAT,CAAuB,SAAvB,IAAoC,SAAS,QAAT,CAAkB,SAAlB,CAApC,GAAmE,SAA7E;AACA,gBAAQ,GAAR,CAAY,KAAZ;AACA,YAAI,OAAO,SAAX,EAAsB;AAClB,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,QAArB,CAAzB,EAAd;AACA,eAAG,OAAH,EAAY,QAAZ;AACA;AACH;AACD,YAAI,SAAS,CAAC,YAAD,EAAe,GAAf,CAAb;AACA,gBAAQ,GAAR,CAAY,WAAZ;AACA,eAAO,eAAP,CAAuB,MAAvB,EAA+B,WAA/B,EAA4C,UAAU,WAAV,EAAuB;AAC/D,gBAAI,WAAW,EAAf;AACA,gBAAI,QAAQ,SAAS,YAAT,CAAsB,GAAtB,IAA6B,SAAS,UAAT,CAAoB,GAApB,CAA7B,GAAwD,EAApE;;AAEA,iBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,YAAY,MAAhC,EAAwC,GAAxC,EAA6C;AACzC,qBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,YAAY,MAAhC,EAAwC,GAAxC,EAA6C;AACzC,wBAAI,YAAY,CAAZ,KAAkB,YAAY,CAAZ,EAAe,YAAf,EAA6B,CAA7B,CAAtB,EAAuD,YAAY,YAAY,CAAZ,EAAe,YAAf,EAA6B,CAA7B,IAAkC,KAAlC,GAA0C,YAAY,CAAZ,EAAe,GAAf,EAAoB,CAApB,CAA1C,GAAmE,GAAnE,GAAyE,KAAzE,GAAiF,IAA7F;AAC1D;AACJ;AACD,oBAAQ,GAAR,CAAY,iBAAZ,EAA+B,QAA/B;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,QAAzB,EAAd;;AAEA,eAAG,OAAH,EAAY,QAAZ;AACH,SAbD;AAcH,KA16BW;AA26BZ,KAAC,mBAAD,EAAsB,SAAtB,EAAiC,OAAjC,EAA0C,MAA1C,EAAkD,EAAlD,EAAsD;AAClD,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,YAAI,WAAW,EAAf;AACA,YAAI,uBAAuB,OAAO,IAAP,CAAY,OAAZ,CAA3B;AACA,YAAI,qBAAqB,CAAC,UAAD,EAAa,UAAb,EAAyB,iBAAzB,EAA4C,iBAA5C,EAA+D,UAA/D,EAA2E,UAA3E,EAAuF,cAAvF,EAAuG,UAAvG,EAAmH,qBAAnH,EAA0I,cAA1I,EAA0J,eAA1J,EAA2K,mBAA3K,EAAgM,aAAhM,EAA+M,gBAA/M,EAAiO,WAAjO,CAAzB;;AAEA,6BAAqB,mBAAmB,MAAnB,CAA0B,UAAU,CAAV,EAAa;AACxD,mBAAO,qBAAqB,OAArB,CAA6B,CAA7B,KAAmC,CAAC,CAA3C;AACH,SAFoB,CAArB;;AAIA,YAAI,MAAM,QAAQ,mBAAmB,CAAnB,CAAR,CAAV;AACA,gBAAQ,GAAR,CAAY,IAAI,WAAJ,EAAZ;AACA,YAAI,mBAAmB,SAAS,aAAT,CAAuB,IAAI,WAAJ,EAAvB,IAA4C,SAAS,YAAT,CAAsB,IAAI,WAAJ,EAAtB,CAA5C,GAAuF,SAA9G;AACA,YAAI,oBAAoB,SAAxB,EAAmC;AAC/B,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,UAArB,CAAzB,EAAd;AACA,eAAG,OAAH,EAAY,QAAZ,EAAsB;AACzB;;AAED,iBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,gBAAzB,EAAd;AACA,WAAG,OAAH,EAAY,QAAZ;AACH,KA/7BW;AAg8BZ,KAAC,uBAAD,EAA0B,SAA1B,EAAqC,OAArC,EAA8C,MAA9C,EAAsD,EAAtD,EAA0D;;AAEtD,YAAI,WAAW,EAAf;AACA,YAAI,aAAa,EAAjB;AACA,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,YAAI,eAAJ;AACA,YAAI,SAAS,aAAT,CAAuB,QAAQ,SAAR,CAAkB,WAAlB,EAAvB,CAAJ,EAA6D;AACzD,8BAAkB,SAAS,aAAT,CAAuB,QAAQ,SAAR,CAAkB,WAAlB,EAAvB,CAAlB;AACA,uBAAW,eAAX,IAA8B,MAA9B;AACH,SAHD,MAGO,IAAI,SAAS,UAAT,CAAoB,QAAQ,SAAR,CAAkB,WAAlB,EAApB,CAAJ,EAA0D;AAC7D,8BAAkB,SAAS,OAAT,CAAiB,QAAQ,SAAR,CAAkB,WAAlB,EAAjB,CAAlB;AACA,uBAAW,eAAX,IAA8B,KAA9B;AACH,SAHM,MAGA;AACH,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,UAArB,CAAzB,EAAd;AACA,eAAG,OAAH,EAAY,QAAZ,EAAsB;AACzB;;AAED,YAAI,MAAM,SAAS,QAAT,CAAkB,QAAQ,SAAR,CAAkB,WAAlB,EAAlB,CAAV;AACA,YAAI,QAAQ,SAAS,YAAT,CAAsB,GAAtB,IAA6B,SAAS,UAAT,CAAoB,GAApB,CAA7B,GAAwD,EAApE;AACA,gBAAQ,GAAR,CAAY,UAAZ,EAAwB,GAAxB;;AAEA,eAAO,YAAP,CAAoB,GAApB,EAAyB,UAAzB,EAAqC,UAAU,IAAV,EAAgB;AACjD,gBAAI,mBAAmB,KAAK,IAAL,CAAU,IAAV,CAAe,CAAf,EAAkB,QAAlB,EAA4B,GAA5B,EAAiC,CAAjC,CAAvB;AACA,gBAAI,oBAAoB,SAAS,eAAT,CAAyB,iBAAzB,EAA4C,QAAQ,SAApD,CAAxB;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,mBAAmB,GAAnB,GAAyB,KAAlD,EAAd;AACA,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,iBAAzB,EAAd;AACA,eAAG,OAAH,EAAY,QAAZ;AACH,SAND;AAOH,KA59BW;AA69BZ,KAAC,eAAD,EAAkB,SAAlB,EAA6B,OAA7B,EAAsC,MAAtC,EAA8C,EAA9C,EAAkD;;AAE9C,YAAI,WAAW,EAAf;AACA,YAAI,YAAY,QAAQ,SAAR,CAAkB,WAAlB,EAAhB;AACA,YAAI,iBAAiB,SAAS,uBAAT,CAAiC,SAAjC,IAA8C,SAAS,kBAAT,CAA4B,SAA5B,CAA9C,GAAuF,IAA5G;AACA,YAAI,mBAAmB,IAAvB,EAA6B;AACzB,gBAAI,UAAU,EAAd;AACA,iBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,EAApB,EAAwB,GAAxB,EAA6B,WAAW,IAAI,CAAJ,GAAQ,IAAR,GAAe,eAAe,CAAf,CAAf,GAAmC,IAA9C;AAC7B,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,cAAzB,EAAd;AACA,eAAG,OAAH,EAAY,QAAZ;AACH,SALD,MAKO;AACH,qBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,UAArB,CAAzB,EAAd;AACA,eAAG,OAAH,EAAY,QAAZ;AACH;AACJ,KA3+BW;;;AA8+BZ,KAAC,OAAD,EAAU,SAAV,EAAqB,OAArB,EAA8B,MAA9B,EAAsC,EAAtC,EAA0C;;AAEtC,YAAI,WAAW,OAAf;AACA,gBAAQ,GAAR,CAAY,QAAZ;AACA,YAAI,WAAW,EAAf;AACA,iBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,QAAzB,EAAd;AACA,WAAG,OAAH,EAAY,QAAZ;AACH,KAr/BW;AAs/BZ,KAAC,iBAAD,EAAoB,SAApB,EAA+B,OAA/B,EAAwC,MAAxC,EAAgD,EAAhD,EAAoD;AAChD,YAAI,WAAW,SAAS,WAAT,CAAqB,oBAArB,CAAf;AACA,iBAAS,WAAT,CAAqB,SAArB,EAAgC,cAAhC,EAAgD,oBAAhD;AACA,YAAI,WAAW,EAAf;AACA,iBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,QAAzB,EAAd;AACA,WAAG,OAAH,EAAY,QAAZ;AACH,KA5/BW;AA6/BZ,KAAC,eAAD,EAAkB,SAAlB,EAA6B,OAA7B,EAAsC,MAAtC,EAA8C,EAA9C,EAAkD;;AAE9C,YAAI,MAAM,IAAV;AACA,YAAI,WAAW,EAAf;AACA,iBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,GAAzB,EAAd;AACA,WAAG,OAAH,EAAY,QAAZ;AACH,KAngCW;AAogCZ,KAAC,eAAD,EAAkB,SAAlB,EAA6B,OAA7B,EAAsC,MAAtC,EAA8C,EAA9C,EAAkD;AAC9C,YAAI,MAAM,SAAS,WAAT,CAAqB,QAArB,CAAV;AACA,YAAI,WAAW,EAAf;AACA,iBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,GAAzB,EAAd;AACA,WAAG,OAAH,EAAY,QAAZ;AACH,KAzgCW;AA0gCZ,KAAC,aAAD,EAAgB,SAAhB,EAA2B,OAA3B,EAAoC,MAApC,EAA4C,EAA5C,EAAgD;AAC5C,YAAI,WAAW,EAAf,CAAkB,SAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,MAArB,CAAzB,EAAd;AAClB,WAAG,OAAH,EAAY,QAAZ;AACH,KA7gCW;AA8gCZ,KAAC,QAAD,EAAW,SAAX,EAAsB,OAAtB,EAA+B,MAA/B,EAAuC,EAAvC,EAA2C;AACvC,YAAI,MAAM,SAAS,WAAT,CAAqB,QAAQ,MAA7B,CAAV;AACA,YAAI,WAAW,EAAf,CAAkB,SAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,GAAzB,EAAd;AAClB,WAAG,OAAH,EAAY,QAAZ;AACH,KAlhCW;AAmhCZ,KAAC,kBAAD,EAAqB,SAArB,EAAgC,OAAhC,EAAyC,MAAzC,EAAiD,EAAjD,EAAqD;AACjD,YAAI,MAAM,SAAS,oBAAT,CAA8B,QAAQ,gBAAtC,CAAV;AACA,YAAI,WAAW,EAAf,CAAkB,SAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,GAAzB,EAAd;AAClB,WAAG,OAAH,EAAY,QAAZ;AACH,KAvhCW;AAwhCZ,KAAC,WAAD,EAAc,SAAd,EAAyB,OAAzB,EAAkC,MAAlC,EAA0C,EAA1C,EAA8C;AAC1C,YAAI,UAAU,uCAAd;AACA,YAAI,WAAW,EAAf;AACA,iBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,OAAzB,EAAd;AACA,WAAG,OAAH,EAAY,QAAZ;AACH,KA7hCW;AA8hCZ,KAAC,mBAAD,EAAsB,SAAtB,EAAiC,OAAjC,EAA0C,MAA1C,EAAkD,EAAlD,EAAsD;AAClD,kBAAU,EAAV;AACA,gBAAQ,GAAR,CAAY,aAAZ;AACA,gBAAQ,GAAR,CAAY,OAAZ;AACA,iBAAS,aAAT,CAAuB,SAAvB,EAAkC,UAAU,IAAV,EAAgB;AAC9C,gBAAI,WAAW,EAAf;AACA,gBAAI,UAAU,IAAd,EAAoB,SAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,OAArB,CAAzB,EAAd;AACpB,gBAAI,UAAU,SAAd,EAAyB,SAAS,IAAT,CAAc,EAAE,MAAM,OAAR,EAAiB,SAAS,SAAS,WAAT,CAAqB,OAArB,CAA1B,EAAd;AACzB,eAAG,OAAH,EAAY,QAAZ;AACH,SALD;AAMH,KAxiCW;;;AA2iCZ,KAAC,eAAD,EAAkB,SAAlB,EAA6B,OAA7B,EAAsC,MAAtC,EAA8C,EAA9C,EAAkD;AAC9C,gBAAQ,GAAR,CAAY,mBAAZ;AACA,YAAI,WAAW,EAAf;AACA,YAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,kBAAU,OAAV,CAAkB,aAAa,YAA/B,EAA6C,UAAU,IAAV,EAAgB;AACzD,oBAAQ,GAAR,CAAY,IAAZ;AACA,gBAAI,KAAK,MAAL,KAAgB,IAAhB,IAAwB,KAAK,MAAL,IAAe,OAA3C,EAAoD;AAChD,wBAAQ,GAAR,CAAY,KAAZ;AACA,yBAAS,WAAT,CAAqB,SAArB,EAAgC,cAAhC,EAAgD,KAAK,QAArD;AACA,0BAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,kBAAlC,EAAsD,mBAAmB,KAAK,QAAxB,GAAmC,WAAzF,EAAsG,IAAtG,CAAV;AACA,yBAAS,WAAT,CAAqB,SAArB,EAAgC,oBAAhC,EAAsD,KAAtD;AACA,yBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,QAAQ,gBAAjC,EAAd;AACA,mBAAG,OAAH,EAAY,QAAZ;AACH,aAPD,MAOO;AACH,wBAAQ,GAAR,CAAY,WAAZ;;AAEA,0BAAU,OAAO,iBAAP,CAAyB,OAAzB,EAAkC,kBAAlC,EAAsD,SAAS,WAAT,CAAqB,UAArB,CAAtD,EAAwF,SAAxF,EAAmG,KAAnG,CAAV;AACA,yBAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,QAAQ,gBAAjC,EAAd;AACA,mBAAG,OAAH,EAAY,QAAZ;AACH;AACJ,SAhBD;AAiBH;AAhkCW,CAAhB;;AAmkCA,SAAS,iBAAT,CAA2B,SAA3B,EAAsC,OAAtC,EAA+C,KAA/C,EAAsD,MAAtD,EAA8D,OAA9D,EAAuE,QAAvE,EAAiF;;AAE7E,QAAI,CAAC,SAAS,eAAT,CAAyB,SAAzB,CAAL,EAA0C,SAAS,aAAT,CAAuB,SAAvB;;AAE1C,QAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,QAAI,UAAU,SAAd,EAAyB;AACrB,YAAI,WAAW,EAAf;AACA,iBAAS,UAAT,IAAuB,OAAvB;AACA,iBAAS,SAAT,IAAsB,EAAtB;AACA,YAAI,SAAS,OAAO,aAAP,CAAqB,SAArB,CAAb;AACH;;AAED,YAAQ,aAAR,CAAsB,OAAtB,EAA+B,OAA/B,EAAwC,UAAU,IAAV,EAAgB;AACpD,YAAI,uBAAuB,KAAK,KAAL,CAAW,IAAX,CAA3B;AACA,gBAAQ,KAAR,CAAc,SAAd,EAAyB,OAAzB,EAAkC,qBAAqB,UAArB,CAAlC,EAAoE,OAApE,EAA6E,UAAU,MAAV,EAAkB;AAC3F,sBAAU,OAAO,eAAP,CAAV;AACA,oBAAQ,GAAR,CAAY,QAAZ,EAAsB,MAAtB;AACA,gBAAI,eAAe,OAAO,cAAP,CAAnB;;AAEA,oBAAQ,GAAR,CAAY,yBAAZ,EAAuC,YAAvC;;AAEA,gBAAI,gBAAgB,IAApB,EAA0B;;AAEtB,oBAAI,WAAW,CAAC,EAAE,MAAM,MAAR,EAAgB,SAAS,SAAS,WAAT,CAAqB,cAArB,CAAzB,EAAD,CAAf;AACA,oBAAI,UAAU,IAAd,EAAoB;AAChB,4BAAQ,GAAR,CAAY,SAAZ,EAAuB,OAAvB,EAAgC,QAAhC;AACH,iBAFD,MAEO,IAAI,UAAU,SAAd,EAAyB;AAC5B,6BAAS,SAAT,IAAsB,CAAC,SAAS,WAAT,CAAqB,cAArB,CAAD,CAAtB;AACA,2BAAO,IAAP,CAAY,aAAZ,EAA2B,QAA3B;AACH;AACJ;;AAED,gBAAI,gBAAgB,eAApB,EAAqC;AACjC,oBAAI,OAAO,WAAP,CAAmB,WAAnB,EAAgC,YAAhC,CAAJ,EAAmD;AAC/C,wBAAI,CAAC,OAAO,WAAP,CAAmB,oBAAnB,EAAyC,YAAzC,CAAL,EAA6D;AACzD,iCAAS,SAAT,CAAmB,SAAnB,EAA8B,WAA9B;AACH,qBAFD,MAEO;AACH,iCAAS,SAAT,CAAmB,oBAAnB,EAAyC,YAAzC;AACH;AACJ;AACJ;;AAED,gBAAI;AACA,wBAAQ,YAAR,EAAsB,SAAtB,EAAiC,OAAjC,EAA0C,MAA1C,EAAkD,UAAU,UAAV,EAAsB,QAAtB,EAAgC;AAC9E,4BAAQ,GAAR,CAAY,yBAAZ;AACA,wBAAI,SAAS,gBAAT,IAA6B,KAAjC,EAAwC;AACpC,4BAAI,eAAe,SAAS,WAAT,CAAqB,SAArB,CAAnB;AACA,4BAAI,kBAAkB,SAAS,iBAAT,CAA2B,YAA3B,EAAyC,YAAzC,EAAuD,UAAvD,EAAmE,QAAnE,CAAtB;AACA,4BAAI,gBAAgB,KAApB;AACA,4BAAI,gBAAgB,eAAhB,IAAmC,gBAAgB,kBAAnD,IAAyE,gBAAgB,eAA7F,EAA8G;AAC1G,gCAAI,aAAa,YAAb,IAA6B,mBAA7B,IAAoD,aAAa,YAAb,IAA6B,kBAAjF,IAAuG,aAAa,YAAb,IAA6B,iBAApI,IAAyJ,aAAa,YAAb,IAA6B,kBAAtL,IAA4M,aAAa,YAAb,IAA6B,gBAAzO,IAA6P,aAAa,YAAb,IAA6B,mBAA1R,IAAiT,aAAa,YAAb,IAA6B,sBAA9U,IAAwW,aAAa,YAAb,IAA6B,oBAArY,IAA6Z,aAAa,YAAb,IAA6B,QAA1b,IAAsc,aAAa,YAAb,IAA6B,aAAne,IAAof,aAAa,YAAb,IAA6B,YAAjhB,IAAiiB,aAAa,YAAb,IAA6B,cAA9jB,IAAglB,aAAa,YAAb,IAA6B,oBAA7mB,IAAqoB,aAAa,YAAb,IAA6B,yBAAlqB,IAA+rB,aAAa,YAAb,IAA6B,eAA5tB,IAA+uB,aAAa,YAAb,IAA6B,wBAA5wB,IAAwyB,aAAa,YAAb,IAA6B,uBAAr0B,IAAg2B,aAAa,YAAb,IAA6B,iBAA73B,IAAk5B,aAAa,YAAb,IAA6B,0BAA/6B,IAA68B,aAAa,YAAb,IAA6B,oBAA9+B,EAAogC;AAChgC,gDAAgB,IAAhB;AACH;AACJ;AACD,4BAAI,gBAAgB,iBAApB,EAAuC,gBAAgB,IAAhB;AACvC,4BAAI,gBAAgB,mBAApB,EAAyC,gBAAgB,IAAhB;;AAEzC,4BAAI,SAAS,gBAAT,CAA0B,YAA1B,EAAwC,OAAxC,KAAoD,IAApD,IAA4D,CAAC,aAAjE,EAAgF;AAC5E,qCAAS,IAAT,CAAc;AACV,sCAAM,MADI;AAEV,yCAAS,SAAS,gBAAT,CAA0B,YAA1B,EAAwC,OAAxC;AAFC,6BAAd;AAIH;AACD,4BAAI,iBAAiB,KAArB,EAA4B;AACxB,qCAAS,IAAT,CAAc,EAAE,MAAM,MAAR,EAAgB,SAAS,eAAzB,EAAd;AACH;AACJ;;AAED,wBAAI,YAAY,SAAS,MAAT,CAAgB,wBAAhB,CAAhB;AACA,gCAAY,IAAI,IAAJ,GAAW,OAAX,EAAZ;;AAEA,yBAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,SAAS,MAA7B,EAAqC,GAArC,EAA0C;AACtC,4BAAI,SAAS,CAAT,EAAY,IAAZ,IAAoB,MAAxB,EAAgC;AAC5B,gCAAI,UAAU,SAAS,CAAT,EAAY,SAAZ,CAAd;AACA,gCAAI,WAAW,IAAX,IAAmB,WAAW,SAAlC,EAA6C,UAAU,IAAV;AAC7C,gCAAI,UAAU;AACV,8CAAc,SADJ,EACe,UAAU,KADzB,EACgC,WAAW,OAD3C;AAEV,4CAAY,KAFF,EAES,aAAa;AAFtB,6BAAd;AAIA,+BAAG,UAAH,CAAc,OAAd,EAAuB,aAAvB;AACH;AACJ;AACD,wBAAI,UAAU,IAAd,EAAoB;AAChB,6BAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,SAAS,MAA7B,EAAqC,GAArC,EAA0C;AACtC,gCAAI,SAAS,CAAT,EAAY,MAAZ,MAAwB,MAA5B,EAAoC;AAChC,oCAAI,aAAa,SAAS,CAAT,EAAY,SAAZ,CAAjB;AACA,yCAAS,CAAT,EAAY,SAAZ,IAAyB,OAAO,gBAAP,CAAwB,UAAxB,CAAzB;AACH;AACJ;AACD,gCAAQ,GAAR,CAAY,SAAZ,EAAuB,UAAvB,EAAmC,QAAnC;AACH,qBARD,MAQO,IAAI,UAAU,SAAd,EAAyB;;AAE5B,+BAAO,IAAP,CAAY,cAAZ,EAA4B,EAAE,YAAY,SAAS,WAAT,CAAqB,YAArB,EAAmC,YAAnC,EAAiD,UAAjD,EAA6D,QAA7D,CAAd,EAA5B;AACA,4BAAI,eAAe,EAAnB;AACA,4BAAI,YAAY,SAAS,MAAT,CAAgB,wBAAhB,CAAhB;AACA,6BAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,SAAS,MAA7B,EAAqC,GAArC,EAA0C;AACtC,gCAAI,SAAS,CAAT,EAAY,IAAZ,IAAoB,MAAxB,EAAgC;AAC5B,6CAAa,IAAb,CAAkB,SAAS,CAAT,EAAY,SAAZ,CAAlB;AACH;AACJ;AACD,iCAAS,SAAT,IAAsB,YAAtB;AACA,+BAAO,IAAP,CAAY,aAAZ,EAA2B,QAA3B;;AAEA,6BAAK,IAAI,IAAI,CAAb,EAAgB,IAAI,SAAS,MAA7B,EAAqC,GAArC,EAA0C;AACtC,gCAAI,MAAM,SAAS,CAAT,CAAV;AACA,qCAAS,SAAT,IAAsB,IAAI,SAAJ,CAAtB;;AAEA,gCAAI,IAAI,IAAJ,IAAY,MAAhB,EAAwB;AACpB,yCAAS,oBAAT,IAAiC,IAAI,oBAAJ,CAAjC;AACA,uCAAO,IAAP,CAAY,UAAZ,EAAwB,QAAxB;AACH,6BAHD,MAGO,IAAI,IAAI,IAAJ,IAAY,SAAhB,EAA2B;;AAE9B,oCAAI,cAAc,IAAI,SAAJ,CAAlB;AACA,oCAAI,SAAS,SAAS,kBAAT,CAA4B,YAA5B,CAAb;AACA,uCAAO,eAAP,CAAuB,MAAvB,EAA+B,WAA/B,EAA4C,UAAU,WAAV,EAAuB;AAC/D,wCAAI,MAAM,EAAV;AACA,wCAAI,SAAJ,IAAiB,YAAY,CAAZ,CAAjB;AACA,wCAAI,SAAJ,IAAiB,YAAY,CAAZ,CAAjB;AACA,6CAAS,SAAT,IAAsB,GAAtB;AACA,2CAAO,IAAP,CAAY,aAAZ,EAA2B,QAA3B;AACH,iCAND;AAOH,6BAXM,MAWA,IAAI,IAAI,IAAJ,IAAY,KAAhB,EAAuB;;AAE1B,oCAAI,cAAc,IAAI,SAAJ,CAAlB;AACA,oCAAI,SAAS,SAAS,kBAAT,CAA4B,YAA5B,CAAb;AACA,uCAAO,eAAP,CAAuB,MAAvB,EAA+B,WAA/B,EAA4C,UAAU,WAAV,EAAuB;AAC/D,6CAAS,SAAT,IAAsB,YAAY,CAAZ,CAAtB;AACA,2CAAO,IAAP,CAAY,SAAZ,EAAuB,QAAvB;AACH,iCAHD;AAIH,6BARM,MAQA,IAAI,IAAI,IAAJ,IAAY,OAAhB,EAAyB;AAC5B,uCAAO,IAAP,CAAY,WAAZ,EAAyB,QAAzB;AACH,6BAFM,MAEA,IAAI,IAAI,IAAJ,IAAY,SAAhB,EAA2B;AAC9B,yCAAS,SAAT,IAAsB,IAAI,SAAJ,CAAtB;AACA,uCAAO,IAAP,CAAY,aAAZ,EAA2B,QAA3B;AACH,6BAHM,MAGA,IAAI,IAAI,IAAJ,IAAY,WAAhB,EAA6B;AAChC,yCAAS,SAAT,IAAsB,IAAI,SAAJ,CAAtB;AACA,uCAAO,IAAP,CAAY,eAAZ,EAA6B,QAA7B;AACH,6BAHM,MAGA,IAAI,IAAI,IAAJ,IAAY,OAAhB,EAAyB;AAC5B,yCAAS,SAAT,IAAsB,IAAI,SAAJ,CAAtB;AACA,uCAAO,IAAP,CAAY,WAAZ,EAAyB,QAAzB;AACH;AACJ;AACD,gCAAQ,GAAR,CAAY,mBAAZ;AACH;AACJ,iBArGD;AAsGH,aAvGD,CAuGE,OAAO,KAAP,EAAc;;AAEZ,wBAAQ,GAAR,CAAY,kCAAZ;;AAEA,yBAAS,SAAT,IAAsB,CAAC,qDAAD,CAAtB;;AAEA,wBAAQ,GAAR,CAAY,KAAZ;AACH;AACJ,SA3ID;AA4IH,KA9ID;AA+IH;;AAED,SAAS,YAAT,CAAsB,CAAtB,EAAyB,IAAzB,EAA+B;AAC3B,WAAO,IAAI,MAAJ,CAAW,QAAQ,IAAR,GAAe,KAA1B,EAAiC,GAAjC,EAAsC,IAAtC,CAA2C,CAA3C,CAAP;AACH;;AAED,OAAO,OAAP,GAAiB;AACb,uBAAmB;;AADN,CAAjB;;;AAMA,IAAI,QAAQ,IAAR,KAAiB,MAArB,EAA6B;AACzB,YAAQ,GAAR,CAAY,mBAAZ;AACA,UAAM,SAAS,QAAf;AACA,WAAO,WAAP;AACH","file":"bot-compiled-compiled.js","sourcesContent":["'use strict';\n\n// Weather Example\n// See https://wit.ai/sungkim/weather/stories and https://wit.ai/docs/quickstart\n//const Wit = require('node-wit').Wit;\n\nconst FB = require('./facebook.js');\nconst Config = require('./../config/const.js');\nconst Search = require('./logics.js');\nconst lContext = require('./localContexts.js');\nconst Sessions = require('./sessions.js');\nvar http = require('http');\nvar Semantics = require('../semantics/check.js');\nconst Messages = require('./messages.js');\nconst witRequest = require('./request.js');\n// const mongoDB = require('./mongodb/update_mongo.js');\nvar watson = require('watson-developer-cloud');\nconst Helper = require('./helper.js');\nconst Mappings = require('./mapping.js');\nconst functions = require('./functions.js');\nvar async = require('async');\nvar winston = require('winston');\nconst witAPIs = require('./witAPIS.js');\nconst global = require('./global.js');\nconst db = require('./pushintodb.js');\nvar moment = require('moment');\n\nfunction getAllEntities(sessionId, context, entities, message, callback) {\n\n    // Store entities in context\n\n    var localContext = lContext.userContext(sessionId);\n\n    Helper.printEntityListFromWit(entities);\n    context = Helper.storeValInContext(context, \"entity_list\", entities, sessionId);\n    context = Helper.addDirectEntitiesToContext(context, entities, sessionId);\n\n    var features = Helper.firstEntityValue(entities, \"features\");\n    if (features && context.mobile) lContext.storeNewSessionKey(sessionId, \"feature_pref\", [features]);\n    if (features) context = Helper.storeValInContext(context, \"features\", features, sessionId);\n\n    var intent = Helper.firstEntityValue(entities, \"intent\");\n    //  if(intent && context.mobile)\n    //    lContext.storeNewSessionKey(sessionId,\"feature_pref\",[intent]);\n\n    if (intent) context = Helper.storeValInContext(context, \"intent\", intent, sessionId);\n\n    if (context.attribute) {\n        var attribute_list = Helper.allEntityValue(entities, 'attribute');\n        context = Helper.storeValInContext(context, \"attribute_list\", attribute_list, sessionId);\n    }\n\n    var query = Helper.firstEntityValue(entities, \"query\");\n    if (query) {\n        if (query == \"what\") context = Helper.storeValInContext(context, \"what\", \"what\", sessionId);\n        if (query == \"why\") context = Helper.storeValInContext(context, \"why\", \"why\", sessionId);\n        if (query == \"how\") context = Helper.storeValInContext(context, \"how\", \"how\", sessionId);\n        if (query == \"does\") context = Helper.storeValInContext(context, \"does\", \"does\", sessionId);\n    }\n\n    if (context.units) {\n        if (context.attribute) context = Helper.storeValInContext(context, \"attribute\", context.attribute, sessionId);\n        if (context.price_range) context = Helper.storeValInContext(context, \"attribute_filter\", context.price_range, sessionId);else context = Helper.storeValInContext(context, \"attribute_filter\", \"above\", sessionId);\n    }\n\n    context = Helper.definePriceRange(message, context, sessionId);\n\n    var in_list = Helper.firstEntityValue(entities, \"list_entity\");\n    var yes_no = Helper.firstEntityValue(entities, \"yes_no\");\n    if (yes_no) context = Helper.storeValInContext(context, \"yes_no\", yes_no, sessionId);\n\n    var brand = Helper.firstEntityValue(entities, \"brand\");\n    if (brand) {\n        context = Helper.storeValInContext(context, \"brand\", brand, sessionId);\n        if (!Helper.isKeyExists(\"brand_pref\", localContext.sessionVars)) lContext.storeNewSessionKey(sessionId, \"brand_pref\", []);\n    }\n\n    if (context.clear) {\n        context = {};\n        context = Helper.storeValInContext(context, \"clear\", context.clear, sessionId);\n    }\n    if (context.intent == \"trivia\") {\n        context = {};\n        context = Helper.storeValInContext(context, \"trivia\", message, sessionId);\n    }\n\n    console.log(\"--------------generated context--------------------\");\n    console.log(context);\n    console.log(\"---------------------------------------------------\");\n\n    message = message.toLowerCase();\n    Helper.getSKUAlias(message, function (data) {\n        var skuList = data[\"skus\"];\n        var aliasList = data['aliases'];\n        if ((Helper.isKeyExists(\"compare\", context) || Helper.isKeyExists(\"better\", context)) && skuList.length >= 2) {\n            context = Helper.storeValInContext(context, \"sku1\", skuList[0], sessionId);\n            context = Helper.storeValInContext(context, \"sku2\", skuList[1], sessionId);\n            delete context.sku;\n            for (var j in aliasList) message = message.replace(aliasList[j], \"\");\n        } else if (skuList.length != 0) {\n            context = Helper.storeValInContext(context, \"sku\", skuList[0], sessionId);\n        }\n\n        for (var i in Mappings.noNoWords) {\n            var nonoword = Mappings.noNoWords[i];\n            if (wordInString(message, nonoword)) {\n                context = {};\n                context = Helper.storeValInContext(context, \"complex_sentence\", nonoword, sessionId);\n                break;\n            }\n        }\n\n        for (var i in Mappings.noNoWordOr) {\n            var nonoword = Mappings.noNoWordOr[i];\n            if (wordInString(message, nonoword)) {\n                if (!(Helper.isKeyExists(\"sku1\", context) && Helper.isKeyExists(\"sku2\", context))) {\n                    context = {};\n                    context = Helper.storeValInContext(context, \"complex_sentence\", nonoword, sessionId);\n                    break;\n                }\n            }\n        }\n\n        for (var i in Mappings.noNoWordNo) {\n            var nonoword = Mappings.noNoWordNo[i];\n            if (wordInString(message, nonoword)) {\n                if (message.toLowerCase() != \"no\" && message.toLowerCase() != \"n\") {\n                    context = {};\n                    context = Helper.storeValInContext(context, \"complex_sentence\", nonoword, sessionId);\n                    break;\n                }\n            }\n        }\n\n        // var nonoword;\n        // if (Mappings.noNoWordOr.some(function(v) {\n        //         if(message.indexOf(v) > -1) nonoword = v;\n        //         return message.indexOf(\" \" + v + \" \") >= 0; })) {\n        //     console.log(\"Banned word is in the function\");\n        //     if(!(Helper.isKeyExists(\"sku1\",context) && Helper.isKeyExists(\"sku2\",context))) {\n        //         context = {};\n        //         context = Helper.storeValInContext(context,\"complex_sentence\",nonoword,sessionId,true);\n        //     }\n        // }\n        // if (Mappings.noNoWordNo.some(function(v) {\n        //         if(message.indexOf(v) > -1) nonoword = v;\n        //         return message.indexOf(\" \" + v + \" \") >= 0; })) {\n        //     console.log(\"Banned word is in the function\");\n        //     if(message.toLowerCase() != \"no\" || message.toLowerCase() != \"n\") {\n        //         context = {};\n        //         context = Helper.storeValInContext(context,\"complex_sentence\",nonoword,sessionId,true);\n        //     }\n        // }\n        // if (Mappings.noNoWords.some(function(v) {\n        //         if(message.indexOf(v) > -1) nonoword = v;\n        //         return message.indexOf(\" \" + v + \" \") >= 0; })) {\n        //     context = {};\n        //     context = Helper.storeValInContext(context,\"complex_sentence\",nonoword,sessionId,true);\n        // }\n\n        if (!Helper.isKeyExists('clear', context) && !Helper.isKeyExists('profanity', context)) {\n            Helper.checkEntities(message, context, sessionId, entities, function (data) {\n                callback && callback(data);\n            });\n        } else {\n            callback && callback(context);\n        }\n    });\n}\n\n// Bot actions\nconst actions = {\n\n    say(sessionId, context, messages) {\n\n        // Bot testing mode, run cb() and return\n        if (require.main === module) {\n            // cb();\n            return;\n        }\n        const recipientId = Sessions.findFBid(sessionId);\n        var localContext = lContext.userContext(sessionId);\n\n        if (recipientId && localContext !== undefined) {\n\n            messages = Helper.breakMessagesForFacebook(messages, '\\n');\n            messages = Helper.breakMessagesForFacebook(messages, '.');\n\n            async.eachSeries(messages, function (listItem, esNext) {\n                if (listItem[\"type\"] === \"text\") {\n                    FB.fbMessage(recipientId, listItem[\"message\"], function (data) {\n                        esNext();\n                    });\n                } else if (listItem[\"type\"] === \"list\") {\n                    FB.fbGenericMessage(recipientId, listItem[\"message\"], function (data) {\n                        esNext();\n                    });\n                }\n            });\n        }\n    },\n    merge(sessionId, context, entities, message, cb) {\n        // Retrieve the location entity and store it into a context field\n\n        var localContext = lContext.userContext(sessionId);\n        var fbId = Sessions.findFBid(sessionId);\n        lContext.storeNewKey(sessionId, \"user_message\", message);\n\n        getAllEntities(sessionId, context, entities, message, function (context) {\n\n            console.log(\"-----------------final context--------------------\");\n            console.log(context);\n            console.log(\"--------------------------------------------------\");\n\n            var functionName = functions.getFunctionName(context);\n            console.log(\"Running function : \" + functionName);\n            if (functionName != null) {\n                lContext.storeNewKey(sessionId, \"preFunction\", functionName);\n                lContext.storeNewKey(sessionId, \"prev_user_question\", context);\n            }\n\n            var final_context_function = {};\n            final_context_function[\"final_context\"] = context;\n            final_context_function[\"bot_function\"] = functionName;\n            cb(final_context_function);\n        });\n    },\n    error(sessionId, context, error) {\n        console.log(error.message);\n        context.error = \"error\";\n    },\n\n    // lists main list , male and female phones list, similar\n    // phones and sort phone list.\n\n    ['findAllPhones'](sessionId, context, source, cb) {\n\n        var localContext = lContext.userContext(sessionId);\n        var spec_sort = {};\n        var spec_query = {};\n        var filter = {};\n        var query;\n        var list_reason_message;\n        var attribute_mapped;\n        var filter_list = [];\n        lContext.storeNewKey(sessionId, \"relevant_attribute\", []);\n        var featureList = [];\n        if (Helper.isKeyExists(\"feature_pref\", localContext.sessionVars)) featureList = localContext.sessionVars.feature_pref;\n\n        if (Helper.isKeyExists('intent', context)) {\n            var key = context.intent.toLowerCase();\n            console.log(\" intent selection\", key);\n            var feature_pref_mapped = [];\n            if (key == \"phonelist_camera\") feature_pref_mapped.push(\"camera\");else if (key == \"phonelist_battery\") feature_pref_mapped.push(\"battery\");else if (key == \"phonelist_memory\") feature_pref_mapped.push(\"memory\");else if (key == \"phonelist_perform\") feature_pref_mapped.push(\"performance\");else if (key == \"phonelist_front_camera\") feature_pref_mapped.push(\"front camera resolution\");\n            console.log(feature_pref_mapped);\n            if (feature_pref_mapped.length > 0) {\n                delete context.intent;\n                lContext.storeNewSessionKey(sessionId, \"feature_pref\", feature_pref_mapped);\n            }\n            if (featureList.length == 0) {\n                spec_sort = Mappings.isSpecSortKeyExists(key) ? Mappings.specSortValue(key) : undefined;\n                list_reason_message = Mappings.isReasonExists(key) ? Mappings.getReasonMessage(key) : undefined;\n            }\n        }\n\n        if (Helper.isKeyExists(\"start_price\", localContext.sessionVars) && Helper.isKeyExists(\"end_price\", localContext.sessionVars)) {\n            filter = {\n                'range': {\n                    'price': {\n                        'gte': localContext.sessionVars.start_price,\n                        'lte': localContext.sessionVars.end_price\n                    }\n                }\n            };\n        }\n\n        if (Helper.isKeyExists(\"popular\", context)) {\n            console.log(\"popular phone\");\n            spec_sort = Mappings.specSortValue(\"popular\");\n            query = { bool: { \"must_not\": [{ \"match\": { \"popular\": 0 } }] } };\n            output = Helper.addPrevQuery(sessionId, query, {}, spec_query, filter);\n            spec_query = output[\"query\"];\n            filter = output[\"filter\"];\n        }\n\n        if (Helper.isKeyExists(\"brand\", context)) {\n            console.log(\"brand phones\");\n            query = { bool: { \"must\": [{ \"match\": { \"brand\": context.brand } }] } };\n            output = Helper.addPrevQuery(sessionId, query, {}, spec_query, filter);\n            spec_query = output[\"query\"];\n            filter = output[\"filter\"];\n        }\n\n        if (Helper.isKeyExists(\"os\", context)) {\n            console.log(\"best os phone\");\n            spec_sort = Mappings.specSortValue(\"os\");\n            query = { bool: { \"must\": [{ \"match\": { \"os\": context.os } }] } };\n            output = Helper.addPrevQuery(sessionId, query, {}, spec_query, filter);\n            spec_query = output[\"query\"];\n            filter = output[\"filter\"];\n        }\n\n        if (Helper.isKeyExists(\"sim_type\", context)) {\n            console.log(\"sim type phone\");\n            query = { bool: { \"must\": [{ \"match\": { \"sim_type\": context.sim_type } }] } };\n            output = Helper.addPrevQuery(sessionId, query, {}, spec_query, filter);\n            spec_query = output[\"query\"];\n            filter = output[\"filter\"];\n        }\n\n        if (Helper.isKeyExists(\"network_support\", context)) {\n            console.log(\"network support phone\");\n            query = { bool: { \"must\": [{ \"match\": { \"network_support\": context.network_support } }] } };\n            output = Helper.addPrevQuery(sessionId, query, {}, spec_query, filter);\n            spec_query = output[\"query\"];\n            filter = output[\"filter\"];\n        }\n\n        if (Helper.isKeyExists(\"processor_type\", context)) {\n            console.log(\"processor type  phones\");\n            query = { bool: { \"must\": [{ \"match_phrase\": { \"processor_type\": context.processor_type } }] } };\n            output = Helper.addPrevQuery(sessionId, query, {}, spec_query, filter);\n            spec_query = output[\"query\"];\n            filter = output[\"filter\"];\n        }\n\n        if (Helper.isKeyExists(\"display_type\", context)) {\n            console.log(\"display type phones\");\n            query = { bool: { \"must\": [{ \"match_phrase\": { \"display_type\": context.display_type } }] } };\n            output = Helper.addPrevQuery(sessionId, query, {}, spec_query, filter);\n            spec_query = output[\"query\"];\n            filter = output[\"filter\"];\n        }\n\n        if (Helper.isKeyExists(\"sensor_type\", context)) {\n            console.log(\"sensor type  phones\");\n            query = { bool: { \"must\": [{ \"match_phrase\": { \"sensors\": context.sensor_type } }] } };\n            output = Helper.addPrevQuery(sessionId, query, {}, spec_query, filter);\n            spec_query = output[\"query\"];\n            filter = output[\"filter\"];\n        }\n\n        if (Helper.isKeyExists('phone_properties', context)) {\n            console.log(\"phone property  phones\");\n            var key = context.phone_properties.toLowerCase();\n            spec_sort = Mappings.isSpecSortKeyExists(key) ? Mappings.specSortValue(key) : undefined;\n            list_reason_message = Mappings.isReasonExists(key) ? Mappings.getReasonMessage(key) : undefined;\n        }\n\n        if (Helper.isKeyExists(\"past_release\", context)) {\n            var dates = Mappings.getPastTime(context.past_release);\n            filter = { \"and\": [{\n                    \"range\": {\n                        \"announced_date\": { \"gte\": dates.start_time,\n                            \"lte\": dates.end_time }\n                    }\n                }, {\n                    \"range\": {\n                        \"price\": { \"gte\": localContext.sessionVars.start_price,\n                            \"lte\": localContext.sessionVars.end_price }\n                    }\n                }]\n            };\n            output = Helper.addPrevQuery(sessionId, {}, filter, spec_query, filter);\n\n            spec_query = output[\"query\"];\n            filter = output[\"filter\"];\n        }\n\n        if (Helper.isKeyExists('attribute', context)) {\n            var attribute_list = context.attribute_list;\n            for (var i in attribute_list) {\n                var attribute = attribute_list[i];\n                var filter_obj = {};\n                var attribute_preposition = null;\n                var attribute_quantity = null;\n                var attribute_values = Helper.allEntityValue(context.entity_list, attribute);\n                console.log(attribute);\n                console.log(context.entity_list);\n                console.log(\"Attribute values\");\n                console.log(attribute_values);\n\n                attribute_mapped = Mappings.isDbKeyExists(attribute.toLowerCase()) ? Mappings.getDbKey(attribute.toLowerCase()) : undefined;\n\n                // Extract if attribute values exist in entities\n                for (var j in attribute_values) {\n                    var value = attribute_values[j];\n                    if (['above', 'below', 'under', 'equal', 'between', 'any'].indexOf(value) > -1) {\n                        attribute_preposition = value;\n                    } else if (!isNaN(value)) {\n                        attribute_quantity = parseInt(value, 10);\n                    }\n                }\n\n                // If attribute value filter exists\n                if (attribute_quantity != null) {\n                    if (attribute_preposition == \"above\" || attribute_preposition == \"equal\" || attribute_preposition == null) filter_obj[attribute_mapped] = { gte: attribute_quantity };else if (attribute_preposition == \"under\") filter_obj[attribute_mapped] = { gte: 0, lte: attribute_quantity };\n                    console.log(\"Adding filter : \" + JSON.stringify(filter_obj, null, 2));\n                    filter_list.push({ 'range': filter_obj });\n\n                    var filter_attribute = {};\n                    filter_attribute[\"and\"] = filter_list;\n\n                    output = Helper.addPrevQuery(sessionId, {}, filter_attribute, spec_query, filter);\n\n                    spec_query = output[\"query\"];\n                    filter = output[\"filter\"];\n                    console.log(\"attribute filter completed.\");\n                } else {\n                    console.log(\"best attribute phone\", context.attribute);\n                    spec_sort = Mappings.isSpecSortKeyExists(attribute) ? Mappings.specSortValue(attribute) : {};\n                    query = Mappings.isQueryExists(attribute) ? Mappings.queryValue(attribute) : {};\n                    output = Helper.addPrevQuery(sessionId, query, {}, spec_query, filter);\n                    spec_query = output[\"query\"];\n                    console.log(spec_sort, spec_query);\n                    filter = output[\"filter\"];\n                    lContext.storeNewSessionKey(sessionId, \"feature_pref\", [attribute]);\n\n                    if (Mappings.isReasonExists(attribute)) list_reason_message = Messages.messageKeyValue(\"listReason\", Mappings.getReasonMessage(attribute));\n                }\n            }\n            var price_range_filter = { 'price': { 'gte': localContext.sessionVars.start_price,\n                    'lte': localContext.sessionVars.end_price } };\n            filter_list.push({ 'range': price_range_filter });\n        }\n\n        /*\r\n         *  completed DB query formation .....\r\n         */\n        if (list_reason_message) lContext.storeNewKey(sessionId, \"list_reason_message\", list_reason_message);\n\n        var messages = [];\n        var output;\n\n        // check user asks in prev list or not..\n        if (Helper.isKeyExists(\"prev_list\", localContext) && !Helper.isKeyExists(\"prev_list_answer\", context) && !Helper.isKeyExists(\"list_synonyms\", context) && !Helper.isKeyExists(\"preference\", context)) {\n            var option_message = {};\n            option_message[\"header\"] = Messages.listMessage(\"listQuestMessage\");\n            option_message[\"options\"] = [\"Yes\", \"No\"];\n            messages.push({ type: \"buttons\", message: option_message });\n            lContext.storeNewKey(sessionId, \"prev_message\", \"listQuestMessage\");\n            cb(context, messages);\n            return;\n        }\n\n        var is_prev_list_answer_exist = Helper.isKeyExists(\"prev_list_answer\", context) || Helper.isKeyExists(\"list_synonyms\", context);\n\n        if (Helper.isKeyExists(\"prev_list\", localContext) && is_prev_list_answer_exist) {\n            var answer = context.prev_list_answer;\n\n            if (answer == \"yes\" || Helper.isKeyExists(\"list_synonyms\", context)) {\n                console.log(\"prev list yes\");\n                var prev_spec_query = localContext.prev_list_query.spec_query;\n                var prev_filter = localContext.prev_list_query.filter;\n                var output = Helper.addPrevQuery(sessionId, spec_query, filter, prev_spec_query, prev_filter);\n                spec_query = output[\"query\"];\n                filter = output[\"filter\"];\n\n                if (featureList.length > 0) feature = featureList[0];else if (Helper.isKeyExists(\"intent\", context)) feature = context.intent.toLowerCase().trim();\n\n                if (spec_query && Object.keys(spec_query).length == 0) spec_query = undefined;\n                if (spec_sort && Object.keys(spec_sort).length == 0) spec_sort = undefined;\n\n                var prev_list = localContext[\"prev_total_list\"];\n                var idList = localContext[\"prev_total_list_ids\"];\n                var newIdList = [];\n                for (var i = 0; i < idList.length; i++) {\n                    newIdList.push(parseInt(idList[i]));\n                }\n\n                fields = Mappings.getFieldsAttribute(\"skuAndroid\");\n\n                // console.log(fields);\n                if (query[\"bool\"] == null) query = { \"bool\": { \"must\": [{ \"ids\": { \"values\": idList } }] } };else query[\"bool\"][\"must\"].push({ \"ids\": { \"values\": idList } });\n\n                Search.findSpecMobile(sort, query, filter, fields, function (data) {\n                    Helper.storePrevQuery(sessionId, spec_sort, spec_query, filter);\n                    cb(context, Helper.printMessagesWhenPrevList(data.hits.hits, sessionId, feature));\n                });\n\n                // cb(context,msgs);\n                return;\n            } else {\n                lContext.deleteKey(sessionId, \"prev_list_query\");\n                lContext.deleteKey(sessionId, \"prev_list\");\n                if (!Helper.isKeyExists(\"features\", context)) lContext.deleteSessionKey(sessionId, \"feature_pref\");\n                lContext.deleteKey(sessionId, \"question_count\");\n            }\n        }\n\n        console.log(\"..................normal flow .........\");\n        console.log(localContext.sessionVars);\n\n        if (!Helper.isKeyExists(\"start_price\", localContext.sessionVars)) {\n            messages.push({ type: \"price\", message: Messages.listMessage(\"priceRange\") });\n            lContext.storeNewKey(sessionId, \"prev_message\", \"priceRangeMessage\");\n            cb(context, messages);\n            return;\n        }\n        console.log(\" price range message ended.\");\n\n        // if the did not specify any feature , let him choose any of the feature\n        if (!Helper.isKeyExists(\"feature_pref\", localContext.sessionVars) && !Helper.isKeyExists(\"intent\", context)) {\n            messages = messages.concat(Helper.specMessage(sessionId, source));\n            cb(context, messages);\n            return;\n        } else {\n            if (Helper.isKeyExists(\"feature_pref\", localContext.sessionVars)) featureList = localContext.sessionVars.feature_pref;\n\n            var feature_user_case_question_key_list = [];\n            if (featureList.length > 0) {\n                for (var z = 0; z < featureList.length; z++) {\n                    var feature = featureList[z].toLowerCase();\n                    var use_case_questions = Messages.hasUseCaseQuests(feature) ? Messages.getUseCaseQuestions(feature) : undefined;\n                    if (use_case_questions != undefined) {\n                        var use_case_preference_keys = Object.keys(use_case_questions);\n                        feature_user_case_question_key_list = feature_user_case_question_key_list.concat(use_case_preference_keys);\n                    }\n                }\n            }\n            console.log(\"length \", feature_user_case_question_key_list);\n            if (feature_user_case_question_key_list.length > 0) {\n\n                var question_count = feature_user_case_question_key_list.length;\n                if (question_count > 0 && !Helper.isKeyExists(\"question_count\", localContext)) {\n                    messages.push({ type: \"text\", message: Messages.countMessages(question_count) });\n                    lContext.storeNewKey(sessionId, \"question_count\", \"yes\");\n                }\n\n                for (var i in feature_user_case_question_key_list) {\n                    var use_case_preference_key = feature_user_case_question_key_list[i];\n                    if (!Helper.isKeyExists(use_case_preference_key, localContext.sessionVars)) {\n                        console.log(\"use case questions for: \", feature + \" key is \" + use_case_preference_key);\n                        lContext.storeNewKey(sessionId, \"prev_message\", use_case_preference_key);\n                        var options = Messages.getUseCaseAnswer(use_case_preference_key);\n                        console.log(options);\n                        var header_question = options[\"header_question\"];\n                        var options_message = {};\n                        options_message[\"header\"] = header_question;\n\n                        if (options[\"type\"] == \"buttons\") {\n                            options_message[\"options\"] = options[\"questions\"];\n                            messages.push({ type: \"buttons\", message: options_message });\n                        } else if (options[\"type\"] == \"checklist\") {\n                            options_message[\"checklist\"] = options[\"questions\"];\n                            options_message[\"max_select\"] = options[\"max_select\"];\n                            messages.push({ type: \"checkList\", message: options_message });\n                        }\n                        lContext.storeNewSessionKey(sessionId, use_case_preference_key, \"nothing\");\n                        cb(context, messages);\n                        return;\n                    }\n                }\n            }\n        }\n\n        console.log(\" DB QUERY FOR FIND PHONES\");\n        var fields = Mappings.getFieldsAttribute(\"skuAndroid\");\n        if (spec_query && Object.keys(spec_query).length == 0) spec_query = undefined;\n        if (spec_sort && Object.keys(spec_sort).length == 0) spec_sort = undefined;\n        //var specSortList = [];\n\n        var listMessages = [];\n\n        if (featureList.length == 1 || Helper.isKeyExists(\"intent\", context)) {\n            if (featureList.length == 1) feature = featureList[0].toLowerCase();else feature = context.intent.toLowerCase().trim();\n            var sort = Mappings.isSpecSortKeyExists(feature) ? Mappings.specSortValue(feature) : undefined;\n            Search.findSpecMobile(sort, spec_query, filter, fields, function (data) {\n                Helper.storePrevQuery(sessionId, spec_sort, spec_query, filter);\n                cb(context, Helper.filterBrandPref(data.hits.hits, source, sessionId, feature, \"one\"));\n            });\n        } else if (featureList.length > 1) {\n            var feature1 = featureList[0].toLowerCase();\n            var feature2 = featureList[1].toLowerCase();\n            Search.findSpecMobile(sort, spec_query, filter, fields, function (data) {\n                Helper.storePrevQuery(sessionId, spec_sort, spec_query, filter);\n                listMessages = listMessages.concat(Helper.filterBrandPref(data.hits.hits, source, sessionId, feature1, \"two\"));\n                Search.findSpecMobile(sort, spec_query, filter, fields, function (data) {\n                    Helper.storePrevQuery(sessionId, spec_sort, spec_query, filter);\n                    listMessages = listMessages.concat(Helper.filterBrandPref(data.hits.hits, source, sessionId, feature2, \"two\"));\n\n                    console.log(listMessages.length);\n\n                    messages.push({ type: \"text\", message: \"Please scroll up to see the results\" });\n                    var listTypeMessages = [];\n                    for (var z = 0; z < listMessages.length; z++) {\n                        var msg = listMessages[z];\n                        if (msg[\"type\"] == \"list\") {\n                            listTypeMessages.push(msg[\"message\"]);\n                        }\n                        if (msg[\"type\"] == \"text\") messages.push(msg);\n                    }\n                    var bottom_message = \"Considering both the lists we have sorted the phones based on best \" + feature1 + \" \" + \"and \" + feature2;\n                    messages.push({ type: \"text\", message: bottom_message });\n                    var combined_list = Helper.processCombinedList(listTypeMessages, feature1, feature2);\n\n                    var relAttribute = Mappings.hasReleventAttriubte(feature1) ? Mappings.getRelevantAttribute(feature1) : [];\n                    relAttribute = relAttribute.concat(Mappings.hasReleventAttriubte(feature2) ? Mappings.getRelevantAttribute(feature2) : []);\n                    messages.push({ type: \"list\", message: combined_list, relevant_attribute: relAttribute });\n\n                    //   console.log(\"final list messages \",messages);\n                    cb(context, messages);\n                });\n            });\n        }\n        //  cb(context,listMessages);\n        // return;\n    },\n    ['sortPhoneList'](sessionId, context, source, cb) {\n        // in two skus\n\n        console.log('sortPhonelist function running');\n        var localContext = lContext.userContext(sessionId);\n        var spec_sort = {};\n        var spec_query = {};\n        var filter = {};\n        var query;\n        var list_reason_message;\n\n        var present_context_keys = Object.keys(context);\n        var sort_key_list = [\"sim_type\", \"sim_size\", \"network_support\", \"camera_features\", \"gps_type\", \"usb_type\", \"display_type\", \"gpu_type\", \"processor_core_type\", \"battery_type\", \"audio_formats\", \"screen_protection\", \"sensor_type\", \"processor_type\", \"attribute\", \"features\"];\n\n        sort_key_list = sort_key_list.filter(function (n) {\n            return present_context_keys.indexOf(n) != -1;\n        });\n\n        var key = context[sort_key_list[0]];\n        key = key.toLowerCase();\n\n        spec_sort = Mappings.isSpecSortKeyExists(key) ? Mappings.specSortValue(key) : undefined;\n        console.log(\"prev list yes\");\n        var prev_spec_query = localContext.prev_list_query.spec_query;\n        var prev_filter = localContext.prev_list_query.filter;\n        var output = Helper.addPrevQuery(sessionId, spec_query, filter, prev_spec_query, prev_filter);\n        spec_query = output[\"query\"];\n        filter = output[\"filter\"];\n\n        if (spec_query && Object.keys(spec_query).length == 0) spec_query = undefined;\n        if (spec_sort && Object.keys(spec_sort).length == 0) spec_sort = undefined;\n\n        var fields = Mappings.getFieldsAttribute(\"skuAndroid\");\n        Search.findSpecMobile(spec_sort, spec_query, filter, fields, function (data) {\n            Helper.storePrevQuery(sessionId, spec_sort, spec_query, filter);\n            cb(context, Helper.printMessagesWhenPrevList(data.hits.hits, sessionId, key));\n        });\n    },\n    ['similarPhones'](sessionId, context, source, cb) {\n        var model_name = context.sku;\n        var field = \"price\";\n        var messages = [];\n\n        Helper.getAttributeValueFromDB(field, model_name, function (result) {\n\n            var price = parseInt(result);\n            var sort = Mappings.specSortValue(\"overall\");\n            var query = undefined;\n            var filter = { 'range': { 'price': { 'gte': price - 5000, 'lte': price + 5000 } } };\n            var fields = Mappings.getFieldsAttribute(\"skuAndroid\");\n            Search.findSpecMobile(sort, query, filter, fields, function (data) {\n\n                var list = data.hits.hits;\n                if (list.length == 0) {\n                    messages.push({ type: \"text\", message: Messages.listMessage(\"notAvailable\") });\n                    cb(context, messages);\n                    return;\n                }\n\n                if (source == \"fb\") {\n                    list = list.slice(0, 7);\n                } else if (source == \"android\") {\n                    list = Helper.addFieldsToList(list);\n                }\n\n                // messages.push({ type: \"text\", message: Messages.listMessage(\"beforeList\") });\n                messages.push({ type: \"list\", message: list, relevant_attribute: [] });\n                // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n                messages.push({ type: \"text\", message: Messages.listMessage(\"afterList\") });\n                cb(context, messages);\n            });\n        });\n    },\n    ['findGenderMobile'](sessionId, context, source, cb) {\n\n        var localContext = lContext.userContext(sessionId);\n        var messages = [];\n        if (!Helper.isKeyExists(\"start_price\", localContext.sessionVars)) {\n            messages.push({ type: \"price\", message: Messages.listMessage(\"priceRangeMessage\") });\n            lContext.storeNewKey(sessionId, \"prev_message\", \"priceRangeMessage\");\n            cb(context, messages);\n            return;\n        }\n        if (!Helper.isKeyExists(\"age\", context)) {\n            if (context.gender == \"female\") messages.push({ type: \"text\", message: Messages.listMessage(\"ageShe\") });else if (context.gender == \"male\") messages.push({ type: \"text\", message: Messages.listMessage(\"ageHe\") });else messages.push({ type: \"text\", message: Messages.listMessage(\"age\") });\n            lContext.storeNewKey(sessionId, \"prev_message\", \"agePrefMessage\");\n            cb(context, messages);\n            return;\n        }\n        var sort;\n        if (context.gender == \"female\") sort = Mappings.specSortValue(\"adult female\");else if (context.gender == \"male\") sort = Mappings.specSortValue(\"adult male\");else if (context.gender == \"kid\") sort = Mappings.specSortValue(\"kids\");\n\n        var query = undefined;\n        var filter_list = [];\n        var price_range_filter = { 'range': { 'price': { 'gte': localContext.sessionVars.start_price,\n                    'lte': localContext.sessionVars.end_price } } };\n        filter_list.push(price_range_filter);\n\n        if (context.age < 15) {\n            var ram_filter = { 'range': { 'ram_memory': { 'gte': 1 } } };\n            filter_list.push(ram_filter);\n            var screen_size_filter = { 'range': { 'screen_size': { 'lt': 4.5 } } };\n            filter_list.push(screen_size_filter);\n            query = { bool: { \"must_not\": [{ \"match\": { \"water_proof_rate\": \"no\" } }] } };\n        }\n        var filter = {};\n        filter[\"and\"] = filter_list;\n\n        var fields = Mappings.getFieldsAttribute(\"skuAndroid\");\n        console.log(sort, query, filter);\n        Search.findSpecMobile(sort, query, filter, fields, function (data) {\n            var list = data.hits.hits;\n            if (list.length == 0) {\n                messages.push({ type: \"text\", message: Messages.listMessage(\"notAvailable\") });\n                cb(context, messages);\n                return;\n            }\n            if (source == \"fb\") {\n                list = list.slice(0, 7);\n                messages.push({ type: \"list\", message: list });\n            } else if (source == \"android\") {\n                var newList = [];\n                for (var i = 0; i < list.length; i++) newList.push(list[i][\"fields\"]);\n                messages.push({ type: \"list\", message: newList, relevant_attribute: [] });\n            }\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n\n    // compare skus and sku specs and attributes\n    ['compareMobiles'](sessionId, context, source, cb) {\n        var localContext = lContext.userContext(sessionId);\n        console.log(\"compare mobile specs\");\n        var key;\n        if (Helper.isKeyExists(\"features\", context)) key = context.features;else if (Helper.isKeyExists(\"attribute\", context)) key = context.attribute;else {\n            if (source == 'fb') key = \"phone\";else key = \"skuAndroid\";\n        }\n\n        var model_names = [context.sku1, context.sku2];\n        console.log(localContext.sku1 + \" \" + localContext.sku2);\n        var messages = [];\n        var fields = [\"model_name\"];\n        console.log(\"Right file\");\n        var attribute_fields = Mappings.getFieldsAttribute(key);\n        console.log(attribute_fields);\n        fields = fields.concat(attribute_fields);\n\n        Helper.getFieldsFromDB(fields, model_names, function (compare_result) {\n\n            messages.push({ type: \"text\", message: Messages.listMessage(\"compare\") });\n            if (source == \"fb\") {\n\n                messages.push({\n                    type: \"text\",\n                    message: Helper.separateKeyValueSKU(compare_result[0], fields, 0, fields.length)\n                });\n                messages.push({\n                    type: \"text\",\n                    message: Helper.separateKeyValueSKU(compare_result[1], fields, 0, fields.length)\n                });\n            } else if (source == \"android\") if (key != \"skuAndroid\") {\n                messages.push({\n                    type: \"text\",\n                    message: Helper.separateKeyValueSKU(compare_result[0], fields, 0, fields.length)\n                });\n                messages.push({\n                    type: \"text\",\n                    message: Helper.separateKeyValueSKU(compare_result[1], fields, 0, fields.length)\n                });\n            }\n            messages.push({ type: \"compare\", message: model_names });\n            // messages.push({type: \"text\", message: Messages.getBrowseMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['betterPhoneInTwo'](sessionId, context, source, cb) {\n        // in two skus\n        var model_names = [context.sku1, context.sku2];\n        var map_key;\n        if (Helper.isKeyExists(\"features\", context)) map_key = context.features;else if (Helper.isKeyExists(\"attribute\", context)) map_key = context.attribute;else map_key = \"better\";\n        Helper.betterMobiles(map_key, model_names, function (messages) {\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['betterThanSKU'](sessionId, context, source, cb) {\n\n        var model_names = [context.sku];\n        var fields = Mappings.getFieldsAttribute(\"skuAndroid\");\n        var messages = [];\n\n        Helper.getFieldsFromDB(fields, model_names, function (result_list) {\n            console.log(result_list);\n            var overall_score = parseFloat(result_list[0][\"overall_score\"]);\n            var price = result_list[0][\"price\"];\n            var specs = Mappings.specSortValue(\"price\");\n            var query = undefined;\n            var filter = { \"and\": [{ \"range\": { \"overall_score\": { \"gte\": overall_score } } }] };\n\n            fields = Mappings.getFieldsAttribute(\"skuAndroid\");\n            Search.findSpecMobile(specs, query, filter, fields, function (data) {\n                var list = data.hits.hits;\n                if (list.length == 0) {\n                    messages.push({ type: \"text\", message: Messages.listMessage(\"notAvailable\") });\n                    cb(context, messages);\n                    return;\n                }\n                Helper.storePrevQuery(sessionId, specs, query, filter);\n                if (source == \"fb\") {\n                    list = list.slice(0, 7);\n                    messages.push({ type: \"list\", message: list });\n                } else if (source == \"android\") {\n                    var newList = [];\n                    for (var i = 0; i < list.length; i++) newList.push(list[i][\"fields\"]);\n                    messages.push({ type: \"list\", message: newList, relevant_attribute: [] });\n                }\n                // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n                cb(context, messages);\n            });\n        });\n    },\n\n    //  single sku question\n    ['getAttributeValueSKU'](sessionId, context, source, cb) {\n        var messages = [];\n        var model_name = context.sku;\n        var attribute = context.attribute.toLowerCase();\n        var key = Mappings.isDbKeyExists(attribute) ? Mappings.getDbKey(attribute) : undefined;\n        if (key == null) {\n            messages.push({ type: \"text\", message: Messages.listMessage(\"noInfo\") });\n            cb(context, messages);\n            return;\n        }\n\n        Helper.getAttributeValueFromDB(key, model_name, function (data) {\n            var units = Mappings.isUnitExists(key) ? Mappings.getUnitKey(key) : \"\";\n            var knowledge_answer = Mappings.haveKnowledge(attribute) ? Mappings.getKnowledge(attribute) : undefined;\n            var send_msg = data + \" \" + units + \"\\n\";\n\n            console.log(key);\n            if (Messages.doesHaveMessageForAttribute(key)) messages.push({ type: \"text\", message: Messages.getHeaderMessageForAttributeValue(key, context) });\n            if (context.attribute == 'rating') {\n                var rating = parseFloat(send_msg);\n                rating = rating.toFixed(2);\n                var message = Messages.ratingMessage(context.sku, rating);\n                messages.push({ type: \"text\", message: message });\n            } else messages.push({ type: \"text\", message: send_msg });\n\n            if (knowledge_answer != undefined) messages.push({ type: \"text\", message: knowledge_answer });\n\n            if (source == \"android\") messages.push({ type: \"sku\", message: [context.sku] });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['singlePhoneDetails'](sessionId, context, source, cb) {\n\n        var model_names = [context.sku];\n        var messages = [];\n        var fields = [\"model_name\"];\n        fields = fields.concat(Mappings.getFieldsAttribute(\"sku\"));\n        Helper.getFieldsFromDB(fields, model_names, function (result_list) {\n            var output = Helper.separateKeyValueSKU(result_list[0], fields, 0, fields.length);\n            messages.push({ type: \"text\", message: output });\n            if (source == \"android\") messages.push({ type: \"sku\", message: model_names });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['specsOfSKU'](sessionId, context, source, cb) {\n\n        console.log(\" running specsOfSku\");\n        var map_key;\n        var localContext = lContext.userContext(sessionId);\n        if (Helper.isKeyExists(\"features\", context)) map_key = context.features;else if (Helper.isKeyExists(\"attribute\", context)) map_key = context.attribute;else map_key = \"sku\";\n        var model_names = [context.sku];\n        var messages = [];\n        var fields = [\"model_name\"];\n        fields = fields.concat(Mappings.getFieldsAttribute(map_key));\n        console.log(\"fields :\", fields);\n        Helper.getFieldsFromDB(fields, model_names, function (result_list) {\n            var output = Helper.separateKeyValueSKU(result_list[0], fields, 0, fields.length);\n            messages.push({ type: \"text\", message: output });\n            if (source == \"android\") messages.push({ type: \"sku\", message: model_names });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['howSpecs'](sessionId, context, source, cb) {\n        actions['specReview'](sessionId, context, source, cb);\n    },\n    [\"dimensionsSKU\"](sessionId, context, source, cb) {\n        var fields = [\"model_name\", \"phone_height\", \"phone_width\", \"thickness\"];\n        var messages = [];\n        Helper.getFieldsFromDB(fields, [context.sku], function (result_list) {\n            console.log(result_list[0]);\n            var output = Helper.separateKeyValueSKU(result_list[0], fields, 0, fields.length);\n            messages.push({ type: \"text\", message: output });\n            if (source == \"android\") messages.push({ type: \"sku\", message: [context.sku] });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['specReview'](sessionId, context, source, cb) {\n\n        var map_key;\n        if (Helper.isKeyExists(\"features\", context)) {\n            map_key = context.features.toLowerCase() + \" review\";\n        } else {\n            map_key = \"verdict\";\n        }\n\n        var messages = [];\n        var model_name = context.sku;\n        var key = Mappings.isDbKeyExists(map_key) ? Mappings.getDbKey(map_key) : undefined;\n        if (key == undefined) {\n            messages.push({ type: \"text\", message: Messages.listMessage(\"noInfo\") });\n            cb(context, messages);\n            return;\n        }\n\n        Helper.getAttributeValueFromDB(key, model_name, function (data) {\n\n            messages.push({ type: \"text\", message: data });\n            if (source == \"android\") messages.push({ type: \"sku\", message: [context.sku] });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['SKUReview'](sessionId, context, source, cb) {\n        var model_name = context.sku;\n        console.log(\"Start of SKUReview function\");\n        Helper.getAttributeValueFromDB('verdict_review', model_name, function (data) {\n            var review = data;\n            var messages = [];\n\n            messages.push({ type: \"text\", message: review });\n            if (source == \"android\") messages.push({ type: \"sku\", message: [context.sku] });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['checkAttributeSKU'](sessionId, context, source, cb) {\n        var localContext = lContext.userContext(sessionId);\n        var messages = [];\n        var present_context_keys = Object.keys(context);\n        var knowledge_key_list = [\"sim_type\", \"network_support\", \"camera_features\", \"gps_type\", \"usb_type\", \"display_type\", \"gpu_type\", \"processor_core_type\", \"battery_type\", \"audio_formats\", \"screen_protection\", \"sensor_type\", \"processor_type\", \"attribute\"];\n\n        knowledge_key_list = knowledge_key_list.filter(function (n) {\n            return present_context_keys.indexOf(n) != -1;\n        });\n        var has_units;\n        if (knowledge_key_list.length != 0) {\n            var key = knowledge_key_list[0];\n            var value = context[knowledge_key_list[0]];\n            has_units = false;\n        }\n\n        if (Helper.isKeyExists(\"units\", context)) {\n            key = Mappings.getDbKey(context.attribute.toLowerCase());\n            value = context.attribute_quantity;\n            has_units = true;\n        }\n\n        var fields = [\"model_name\", key];\n        var output;\n\n        Helper.getFieldsFromDB(fields, [context.sku], function (result_list) {\n\n            console.log(\"result list\", result_list);\n            if (has_units) {\n                var result = parseInt(result_list[0][key][0]);\n                value = parseInt(value);\n                console.log(typeof result, typeof value);\n                if (result == value) output = \"Yes\";else output = \"No\";\n            } else {\n                var result = result_list[0][key][0].toLowerCase();\n                value = value.toLowerCase();\n                if (result.indexOf(value) > -1) output = \"Yes\";else output = \"No\";\n            }\n\n            messages.push({ type: \"text\", message: output });\n            if (source == \"android\") messages.push({ type: \"sku\", message: [context.sku] });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['ratingMobile'](sessionId, context, source, cb) {\n\n        var rating_field;\n        if (context.platforms == \"flipkart\") rating_field = [\"average_rating_flipkart\", \"no_of_ratings_flipkart\"];else if (context.platforms == \"amazon\") rating_field = [\"average_rating_amazon\", \"no_of_ratings_amazon\"];\n\n        Search.ratingPhone(context.platforms, rating_field, context.sku, function (data) {\n            var rating = context.attribute === 'rating' ? data.hits.hits[0][\"fields\"][rating_field[0]][0] : data.hits.hits[0][\"fields\"][rating_field[1]][0];\n            if (rating == 0) rating = Messages.listMessage(\"noRating\");\n            rating = context.platforms + \" ratings for \" + context.sku + \" is \" + rating;\n            var messages = [];\n            messages.push({ type: \"text\", message: rating });\n            if (source == \"android\") messages.push({ type: \"sku\", message: [context.sku] });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['buyPhone'](sessionId, context, source, cb) {\n\n        var localContext = lContext.userContext(sessionId);\n        Helper.getAttributeValueFromDB(\"purchase_url\", context.sku, function (data) {\n            var messages = [];\n            messages.push({ type: \"text\", message: data });\n            if (source == \"android\") messages.push({ type: \"sku\", message: [context.sku] });\n            cb(context, messages);\n        });\n    },\n    ['positiveSKU'](sessionId, context, source, cb) {\n        Helper.getAttributeValueFromDB(\"pros\", context.sku, function (data) {\n            var messages = [];\n            messages.push({ type: \"text\", message: data });\n            if (source == \"android\") messages.push({ type: \"sku\", message: [context.sku] });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['negativeSKU'](sessionId, context, source, cb) {\n        Helper.getAttributeValueFromDB(\"cons\", context.sku, function (data) {\n            var messages = [];\n            messages.push({ type: \"text\", message: data });\n            if (source == \"android\") messages.push({ type: \"sku\", message: [context.sku] });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['opinionSKU'](sessionId, context, source, cb) {\n        var messages = [];\n        var fields = ['pros', 'cons', \"model_name\"];\n        Helper.getFieldsFromDB(fields, [context.sku], function (result_list) {\n\n            var pros = \"Pros: \\n\" + result_list[0][\"pros\"][0];\n            var cons = \"Cons: \\n\" + result_list[0][\"cons\"][0];\n            var messages = [];\n            messages.push({ type: \"text\", message: pros });\n            messages.push({ type: \"text\", message: cons });\n            if (source == \"android\") messages.push({ type: \"sku\", message: [context.sku] });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['publicTalk'](sessionId, context, source, cb) {\n        var messages = [];\n        var model_name = context.sku;\n        var key = \"user_review\";\n        if (key == null) {\n            messages.push({ type: \"text\", message: Messages.listMessage(\"noInfo\") });\n            cb(context, messages);\n            return;\n        }\n\n        Helper.getAttributeValueFromDB(key, model_name, function (data) {\n            console.log(data);\n\n            var send_msg = data + \"  \\n\";\n\n            messages.push({ type: \"text\", message: send_msg });\n            if (source == \"android\") messages.push({ type: \"sku\", message: [context.sku] });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n\n    // knowledge questions\n    ['getAttributeValueALL'](sessionId, context, source, cb) {\n        var model_names = [];\n        var localContext = lContext.userContext(sessionId);\n        var phone_list = localContext[\"user_shown_list\"];\n        for (var i = 0; i < phone_list.length; i++) model_names.push(phone_list[i][\"fields\"][\"model_name\"][0]);\n        var messages = [];\n        var attribute = context.attribute.toLowerCase();\n        console.log(attribute);\n        var key = Mappings.isDbKeyExists(attribute) ? Mappings.getDbKey(attribute) : undefined;\n        console.log(\"key\");\n        if (key == undefined) {\n            messages.push({ type: \"text\", message: Messages.listMessage(\"noInfo\") });\n            cb(context, messages);\n            return;\n        }\n        var fields = [\"model_name\", key];\n        console.log(model_names);\n        Helper.getFieldsFromDB(fields, model_names, function (result_list) {\n            var send_msg = \"\";\n            var units = Mappings.isUnitExists(key) ? Mappings.getUnitKey(key) : \"\";\n\n            for (var k = 0; k < model_names.length; k++) {\n                for (var j = 0; j < result_list.length; j++) {\n                    if (model_names[k] == result_list[j][\"model_name\"][0]) send_msg += result_list[j][\"model_name\"][0] + \" : \" + result_list[j][key][0] + \" \" + units + \"\\n\";\n                }\n            }\n            console.log(\"sending message\", send_msg);\n            messages.push({ type: \"text\", message: send_msg });\n            // messages.push({type: \"text\", message: Messages.listMessage(\"scroll\")});\n            cb(context, messages);\n        });\n    },\n    ['knowledgeQuestion'](sessionId, context, source, cb) {\n        var localContext = lContext.userContext(sessionId);\n        var messages = [];\n        var present_context_keys = Object.keys(context);\n        var knowledge_key_list = [\"sim_type\", \"sim_size\", \"network_support\", \"camera_features\", \"gps_type\", \"usb_type\", \"display_type\", \"gpu_type\", \"processor_core_type\", \"battery_type\", \"audio_formats\", \"screen_protection\", \"sensor_type\", \"processor_type\", \"attribute\"];\n\n        knowledge_key_list = knowledge_key_list.filter(function (n) {\n            return present_context_keys.indexOf(n) != -1;\n        });\n\n        var key = context[knowledge_key_list[0]];\n        console.log(key.toLowerCase());\n        var knowledge_answer = Mappings.haveKnowledge(key.toLowerCase()) ? Mappings.getKnowledge(key.toLowerCase()) : undefined;\n        if (knowledge_answer == undefined) {\n            messages.push({ type: \"text\", message: Messages.listMessage(\"notFound\") });\n            cb(context, messages);return;\n        }\n\n        messages.push({ type: \"text\", message: knowledge_answer });\n        cb(context, messages);\n    },\n    ['bestAttributeInMarket'](sessionId, context, source, cb) {\n\n        var messages = [];\n        var field_rank = {};\n        var localContext = lContext.userContext(sessionId);\n        var attribute_score;\n        if (Mappings.hasSpecScores(context.attribute.toLowerCase())) {\n            attribute_score = Mappings.getSpecScores(context.attribute.toLowerCase());\n            field_rank[attribute_score] = 'desc';\n        } else if (Mappings.isHaveRank(context.attribute.toLowerCase())) {\n            attribute_score = Mappings.getRank(context.attribute.toLowerCase());\n            field_rank[attribute_score] = 'asc';\n        } else {\n            messages.push({ type: \"text\", message: Messages.listMessage(\"notFound\") });\n            cb(context, messages);return;\n        }\n\n        var key = Mappings.getDbKey(context.attribute.toLowerCase());\n        var units = Mappings.isUnitExists(key) ? Mappings.getUnitKey(key) : \"\";\n        console.log(field_rank, key);\n\n        Search.getFieldRank(key, field_rank, function (data) {\n            var attribute_market = data.hits.hits[0]['fields'][key][0];\n            var attribute_market1 = Messages.messageKeyValue(\"messageKeyValue\", context.attribute);\n            messages.push({ type: \"text\", message: attribute_market + \" \" + units });\n            messages.push({ type: \"text\", message: attribute_market1 });\n            cb(context, messages);\n        });\n    },\n    [\"attributeList\"](sessionId, context, source, cb) {\n\n        var messages = [];\n        var attribute = context.attribute.toLowerCase();\n        var attribute_list = Mappings.isrankedAttributeExists(attribute) ? Mappings.getrankedAttribute(attribute) : \"no\";\n        if (attribute_list !== \"no\") {\n            var message = \"\";\n            for (var i = 0; i < 10; i++) message += i + 1 + \". \" + attribute_list[i] + \"\\n\";\n            messages.push({ type: \"text\", message: attribute_list });\n            cb(context, messages);\n        } else {\n            messages.push({ type: \"text\", message: Messages.listMessage(\"notFound\") });\n            cb(context, messages);\n        }\n    },\n\n    // text sending to user\n    ['greet'](sessionId, context, source, cb) {\n\n        var response = \"Hello\";\n        console.log(response);\n        var messages = [];\n        messages.push({ type: \"text\", message: response });\n        cb(context, messages);\n    },\n    ['betterThanPhone'](sessionId, context, source, cb) {\n        var response = Messages.listMessage('presentSKUQuestion');\n        lContext.storeNewKey(sessionId, \"prev_message\", \"presentSKUQuestion\");\n        var messages = [];\n        messages.push({ type: \"text\", message: response });\n        cb(context, messages);\n    },\n    ['posExpression'](sessionId, context, source, cb) {\n\n        var msg = \":)\";\n        var messages = [];\n        messages.push({ type: \"text\", message: msg });\n        cb(context, messages);\n    },\n    ['negExpression'](sessionId, context, source, cb) {\n        var msg = Messages.listMessage(\"negExp\");\n        var messages = [];\n        messages.push({ type: \"text\", message: msg });\n        cb(context, messages);\n    },\n    ['helpMessage'](sessionId, context, source, cb) {\n        var messages = [];messages.push({ type: \"text\", message: Messages.listMessage(\"help\") });\n        cb(context, messages);\n    },\n    ['trivia'](sessionId, context, source, cb) {\n        var msg = Messages.triviaReply(context.trivia);\n        var messages = [];messages.push({ type: \"text\", message: msg });\n        cb(context, messages);\n    },\n    ['complex_sentence'](sessionId, context, source, cb) {\n        var msg = Messages.complexSentenceReply(context.complex_sentence);\n        var messages = [];messages.push({ type: \"text\", message: msg });\n        cb(context, messages);\n    },\n    ['profanity'](sessionId, context, source, cb) {\n        var message = \"That's not a proper language to use. \";\n        var messages = [];\n        messages.push({ type: \"text\", message: message });\n        cb(context, messages);\n    },\n    ['destroyEverything'](sessionId, context, source, cb) {\n        context = {};\n        console.log(\"new Context\");\n        console.log(context);\n        lContext.deleteContext(sessionId, function (data) {\n            var messages = [];\n            if (source == \"fb\") messages.push({ type: \"text\", message: Messages.listMessage(\"clear\") });\n            if (source == \"android\") messages.push({ type: \"clear\", message: Messages.listMessage(\"clear\") });\n            cb(context, messages);\n        });\n    },\n\n    //check sentence\n    ['checkSentence'](sessionId, context, source, cb) {\n        console.log(\"check sentence in\");\n        var messages = [];\n        var localContext = lContext.userContext(sessionId);\n        Semantics.findSim(localContext.user_message, function (data) {\n            console.log(data);\n            if (data.status === true || data.status == 'check') {\n                console.log(\"yes\");\n                lContext.storeNewKey(sessionId, \"last_message\", data.sentence);\n                context = Helper.storeValInContext(context, \"checked_sentence\", \"Do you mean \\'\" + data.sentence + \"\\' Y / N \", true);\n                lContext.storeNewKey(sessionId, \"next_check_message\", \"yes\");\n                messages.push({ type: \"text\", message: context.checked_sentence });\n                cb(context, messages);\n            } else {\n                console.log(\"new error\");\n                //context = Helper.storeValInContext(context, \"check_message\", \"no\", false);\n                context = Helper.storeValInContext(context, \"checked_sentence\", Messages.listMessage(\"notFound\"), sessionId, false);\n                messages.push({ type: \"text\", message: context.checked_sentence });\n                cb(context, messages);\n            }\n        });\n    }\n};\n\nfunction witProcessMessage(sessionId, message, email, source, context, callback) {\n\n    if (!lContext.isSessionExists(sessionId)) lContext.createContext(sessionId);\n\n    var localContext = lContext.userContext(sessionId);\n    if (source == \"android\") {\n        var sendJson = {};\n        sendJson[\"username\"] = \"prodX\";\n        sendJson[\"message\"] = \"\";\n        var socket = global.getUserSocket(sessionId);\n    }\n\n    witAPIs.witMessageAPI(message, context, function (data) {\n        var message_api_response = JSON.parse(data);\n        actions.merge(sessionId, context, message_api_response[\"entities\"], message, function (result) {\n            context = result[\"final_context\"];\n            console.log(\"result\", result);\n            var bot_function = result[\"bot_function\"];\n\n            console.log(\"bot function in wit api\", bot_function);\n\n            if (bot_function == null) {\n                // no function to execute  // send sorry message..\n                var messages = [{ type: \"text\", message: Messages.listMessage(\"sorryMessage\") }];\n                if (source == \"fb\") {\n                    actions.say(sessionId, context, messages);\n                } else if (source == \"android\") {\n                    sendJson[\"message\"] = [Messages.listMessage(\"sorryMessage\")];\n                    socket.emit(\"bot message\", sendJson);\n                }\n            }\n\n            if (bot_function != \"findAllPhones\") {\n                if (Helper.isKeyExists(\"prev_list\", localContext)) {\n                    if (!Helper.isKeyExists(\"has_list_reference\", localContext)) {\n                        lContext.deleteKey(sessionId, \"prev_list\");\n                    } else {\n                        lContext.deleteKey(\"has_list_reference\", localContext);\n                    }\n                }\n            }\n\n            try {\n                actions[bot_function](sessionId, context, source, function (newContext, messages) {\n                    console.log(\"response after function\");\n                    if (lContext.question_message != \"yes\") {\n                        var localContext = lContext.userContext(sessionId);\n                        var pointer_message = Messages.getPointerMessage(localContext, bot_function, newContext, messages);\n                        var questionAsked = false;\n                        if (bot_function == \"findAllPhones\" || bot_function == \"findGenderMobile\" || bot_function == \"betterThanSKU\") {\n                            if (localContext.prev_message == \"priceRangeMessage\" || localContext.prev_message == \"brandPrefMessage\" || localContext.prev_message == \"specPrefMessage\" || localContext.prev_message == \"listQuestMessage\" || localContext.prev_message == \"agePrefMessage\" || localContext.prev_message == \"front_camera_pref\" || localContext.prev_message == \"video_recording_pref\" || localContext.prev_message == \"photo_storage_pref\" || localContext.prev_message == \"gaming\" || localContext.prev_message == \"app_running\" || localContext.prev_message == \"spend_time\" || localContext.prev_message == \"network_type\" || localContext.prev_message == \"spend_time_battery\" || localContext.prev_message == \"after_battery_important\" || localContext.prev_message == \"record_videos\" || localContext.prev_message == \"after_camera_important\" || localContext.prev_message == \"frequent_use_activity\" || localContext.prev_message == \"use_phone_light\" || localContext.prev_message == \"relevant_internal_memory\" || localContext.prev_message == \"micro_sd_card_cost\") {\n                                questionAsked = true;\n                            }\n                        }\n                        if (bot_function == \"betterThanPhone\") questionAsked = true;\n                        if (bot_function == \"destroyEverything\") questionAsked = true;\n\n                        if (Messages.getBrowseMessage(bot_function, context) != null && !questionAsked) {\n                            messages.push({\n                                type: \"text\",\n                                message: Messages.getBrowseMessage(bot_function, context)\n                            });\n                        }\n                        if (questionAsked == false) {\n                            messages.push({ type: \"text\", message: pointer_message });\n                        }\n                    }\n\n                    var timestamp = moment().format('MMM DD, YYYY,h:mm:ss a');\n                    timestamp = new Date().getTime();\n\n                    for (var j = 0; j < messages.length; j++) {\n                        if (messages[j].type == \"text\") {\n                            var content = messages[j]['message'];\n                            if (content == null || content == undefined) content = \"  \";\n                            var details = {\n                                'session_id': sessionId, 'sender': 'bot', 'content': content,\n                                'username': email, 'timestamp': timestamp\n                            };\n                            db.inserttodB(details, \"chatapp_msg\");\n                        }\n                    }\n                    if (source == \"fb\") {\n                        for (var i = 0; i < messages.length; i++) {\n                            if (messages[i][\"type\"] === \"list\") {\n                                var phone_list = messages[i][\"message\"];\n                                messages[i][\"message\"] = Helper.makeListFBFormat(phone_list);\n                            }\n                        }\n                        actions.say(sessionId, newContext, messages);\n                    } else if (source == \"android\") {\n\n                        socket.emit(\"bot pointers\", { \"pointers\": Messages.getPointers(localContext, bot_function, newContext, messages) });\n                        var textMessages = [];\n                        var timestamp = moment().format('MMM DD, YYYY,h:mm:ss a');\n                        for (var j = 0; j < messages.length; j++) {\n                            if (messages[j].type == \"text\") {\n                                textMessages.push(messages[j][\"message\"]);\n                            }\n                        }\n                        sendJson[\"message\"] = textMessages;\n                        socket.emit(\"bot message\", sendJson);\n\n                        for (var i = 0; i < messages.length; i++) {\n                            var msg = messages[i];\n                            sendJson[\"message\"] = msg[\"message\"];\n\n                            if (msg.type == \"list\") {\n                                sendJson[\"relevant_attribute\"] = msg[\"relevant_attribute\"];\n                                socket.emit(\"bot list\", sendJson);\n                            } else if (msg.type == \"compare\") {\n\n                                var model_names = msg[\"message\"];\n                                var fields = Mappings.getFieldsAttribute(\"skuAndroid\");\n                                Helper.getFieldsFromDB(fields, model_names, function (result_list) {\n                                    var obj = {};\n                                    obj[\"mobile1\"] = result_list[0];\n                                    obj[\"mobile2\"] = result_list[1];\n                                    sendJson[\"message\"] = obj;\n                                    socket.emit(\"bot compare\", sendJson);\n                                });\n                            } else if (msg.type == \"sku\") {\n\n                                var model_names = msg[\"message\"];\n                                var fields = Mappings.getFieldsAttribute(\"skuAndroid\");\n                                Helper.getFieldsFromDB(fields, model_names, function (result_list) {\n                                    sendJson[\"message\"] = result_list[0];\n                                    socket.emit(\"bot sku\", sendJson);\n                                });\n                            } else if (msg.type == \"clear\") {\n                                socket.emit(\"bot clear\", sendJson);\n                            } else if (msg.type == \"buttons\") {\n                                sendJson[\"message\"] = msg[\"message\"];\n                                socket.emit(\"bot buttons\", sendJson);\n                            } else if (msg.type == \"checkList\") {\n                                sendJson[\"message\"] = msg[\"message\"];\n                                socket.emit(\"bot checkList\", sendJson);\n                            } else if (msg.type == \"price\") {\n                                sendJson[\"message\"] = msg[\"message\"];\n                                socket.emit(\"bot price\", sendJson);\n                            }\n                        }\n                        console.log(\"all messages sent\");\n                    }\n                });\n            } catch (error) {\n\n                console.log(\" ERROR IN SUB FUNCTION SEE THAT \");\n\n                sendJson[\"message\"] = [\"Unable to process the question. Please rephrase it.\"];\n                //  socket.emit(\"bot message\", sendJson);\n                console.log(error);\n            }\n        });\n    });\n}\n\nfunction wordInString(s, word) {\n    return new RegExp('\\\\b' + word + '\\\\b', 'i').test(s);\n}\n\nmodule.exports = {\n    witProcessMessage: witProcessMessage\n\n};\n// bot testing mode\n// http://stackoverflow.com/questions/6398196\nif (require.main === module) {\n    console.log(\"Bot testing mode.\");\n    const client = getWit();\n    client.interactive();\n}\n\n//# sourceMappingURL=bot-compiled.js.map"]}