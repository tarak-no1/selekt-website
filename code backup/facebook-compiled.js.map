{"version":3,"sources":["facebook.js"],"names":[],"mappings":"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","file":"facebook-compiled.js","sourcesContent":["'use strict';\r\n\r\n// See the Send API reference\r\n// https://developers.facebook.com/docs/messenger-platform/send-api-reference\r\nconst request = require('request');\r\nconst Config = require('./../config/const.js');\r\n\r\n\r\nconst fbReq = request.defaults({\r\n  uri: 'https://graph.facebook.com/me/messages',\r\n  method: 'POST',\r\n  json: true,\r\n  qs: {\r\n    access_token: Config.FB_PAGE_TOKEN\r\n  },\r\n  headers: {\r\n    'Content-Type': 'application/json'\r\n  },\r\n});\r\n\r\n\r\nconst fbMessage =function (recipientId, msg, cb)  {\r\n  const opts = {\r\n      form: {\r\n          recipient: {\r\n          id: recipientId,\r\n        },\r\n        message: {\r\n          text: msg,\r\n        },\r\n    },\r\n  };\r\n\r\n  fbReq(opts, function(err, resp, data)  {\r\n    if (cb) {\r\n      cb(err || data.error && data.error.message, data);\r\n    }\r\n  });\r\n\r\n};\r\n\r\nconst fbImageMessage = function(recipientId, msg, cb)  {\r\n  const opts = {\r\n      form: {\r\n          recipient: {\r\n          id: recipientId,\r\n        },\r\n        message: {\r\n          attachment : {\r\n              type : \"image\",\r\n              payload : {\r\n                 url : \"http://instomeal.com/static/chef_photos/10.jpg\" \r\n              }\r\n          }\r\n\r\n        },\r\n    },\r\n  };\r\n\r\n  fbReq(opts, function(err, resp, data)  {\r\n    if (cb) {\r\n      cb(err || data.error && data.error.message, data);\r\n    }\r\n  });\r\n  \r\n};\r\n\r\n\r\nconst fbButtonMessage = function(recipientId, msg, cb){\r\n  const opts = {\r\n      form: {\r\n          recipient: {\r\n          id: recipientId,\r\n        },\r\n        message: {\r\n            \"attachment\":{\r\n            \"type\":\"template\",\r\n            \"payload\":{\r\n                   \"template_type\":\"button\",\r\n                    \"text\":msg,\r\n                    \"buttons\":[\r\n                      {\r\n                      \"type\":\"web_url\",\r\n                      \"url\":\"https://petersapparel.parseapp.com\",\r\n                      \"title\":\"Show Website\"\r\n                      },\r\n                      {\r\n                      \"type\":\"postback\",\r\n                      \"title\":\"Start Chatting\",\r\n                      \"payload\":\"Chatting\"\r\n                      }\r\n                 ]\r\n              }\r\n           }\r\n        },\r\n    },\r\n  };\r\n\r\n  fbReq(opts, (err, resp, data) => {\r\n    if (cb) {\r\n      cb(err || data.error && data.error.message, data);\r\n    }\r\n  });\r\n  \r\n};\r\n// horizontal scroll msg\r\nconst fbGenericMessage = (recipientId, elements, cb) => {\r\n  const opts = {\r\n      form: {\r\n            recipient: {\r\n            id: recipientId,\r\n          },\r\n          \"message\":{\r\n           \"attachment\":{\r\n            \"type\":\"template\",\r\n            \"payload\":{\r\n              \"template_type\":\"generic\",\r\n              \"elements\": elements\r\n          }\r\n        },\r\n      },\r\n   }\r\n  };\r\n\r\n  fbReq(opts, (err, resp, data) => {\r\n    if (cb) {\r\n      cb(err || data.error && data.error.message, data);\r\n    }\r\n  });\r\n\r\n};\r\n\r\n// See the Webhook reference\r\n// https://developers.facebook.com/docs/messenger-platform/webhook-reference\r\nconst getFirstMessagingEntry = (body) => {\r\n  const val = body.object === 'page' &&\r\n    body.entry &&\r\n    Array.isArray(body.entry) &&\r\n    body.entry.length > 0 &&\r\n    body.entry[0] &&\r\n    body.entry[0].messaging &&\r\n    Array.isArray(body.entry[0].messaging) &&\r\n    body.entry[0].messaging.length > 0 &&\r\n    body.entry[0].messaging[0];\r\n\r\n  return val || null;\r\n};\r\n\r\nmodule.exports = {\r\n  getFirstMessagingEntry: getFirstMessagingEntry,\r\n  fbMessage: fbMessage,\r\n  fbReq: fbReq,\r\n  fbImageMessage:fbImageMessage,\r\n  fbButtonMessage:fbButtonMessage,\r\n  fbGenericMessage:fbGenericMessage\r\n};"]}